{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/yelee/source/apple-touch-icon.png","path":"apple-touch-icon.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-1.jpg","path":"background/bg-1.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-2.jpg","path":"background/bg-2.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-4.jpg","path":"background/bg-4.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-3.jpg","path":"background/bg-3.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-5.jpg","path":"background/bg-5.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-6.jpg","path":"background/bg-6.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-7.jpg","path":"background/bg-7.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-8.jpg","path":"background/bg-8.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/css/eventflow.css","path":"css/eventflow.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/css/post_drag.css","path":"css/post_drag.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/GitHub.png","path":"img/GitHub.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/SegmentFault.png","path":"img/SegmentFault.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/TiddlyWiki.png","path":"img/TiddlyWiki.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/V2EX.png","path":"img/V2EX.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/avatar.png","path":"img/avatar.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/eventflow.png","path":"img/eventflow.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/eventflow.svg","path":"img/eventflow.svg","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/img-err.png","path":"img/img-err.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/img-loading.png","path":"img/img-loading.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/scrollbar_arrow.png","path":"img/scrollbar_arrow.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/新浪微博.png","path":"img/新浪微博.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/知乎.png","path":"img/知乎.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/简书.png","path":"img/简书.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/网易云音乐.png","path":"img/网易云音乐.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/虾米音乐.png","path":"img/虾米音乐.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/img/豆瓣.png","path":"img/豆瓣.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/GithubRepoWidget.js","path":"js/GithubRepoWidget.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/clipboard.min.js","path":"js/clipboard.min.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/eventflow.js","path":"js/eventflow.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/instagram.js","path":"js/instagram.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/jquery.lazyload.js","path":"js/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/mobile.js","path":"js/mobile.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/particles.json","path":"js/particles.json","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/particles.min.js","path":"js/particles.min.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/pc.js","path":"js/pc.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/js/post_drag.js","path":"js/post_drag.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-10.jpg","path":"background/bg-10.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/background/bg-9.jpg","path":"background/bg-9.jpg","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/css/font-awesome.css","path":"font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/css/font-awesome.min.css","path":"font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/fonts/FontAwesome.otf","path":"font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.eot","path":"font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.woff","path":"font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.woff2","path":"font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.ttf","path":"font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.svg","path":"font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"themes/yelee/.gitignore","hash":"79b4a9ac435bc5833a0bc461ebacb10908b34ed3","modified":1464945259938},{"_id":"themes/yelee/README.md","hash":"052a9debfddb265c8d334bbdc26302d61f6a692f","modified":1464945259938},{"_id":"themes/yelee/_config.yml","hash":"a1b9ee185387d3b7136acdf47a189f37c5c8bb22","modified":1465020383972},{"_id":"themes/yelee/package.json","hash":"0199dfb3d44cf520b67464817d13c44a7766b8d6","modified":1464945259951},{"_id":"source/_posts/2015-01-15-my-first-blog.markdown","hash":"4bc58cca0f26aefc90ee7e40405683579b0b4fe3","modified":1464945259855},{"_id":"source/_posts/2015-01-16-css3clock.markdown","hash":"8501c8ed8a2b2285d0ec91d3b8d6708c5be3d162","modified":1464945259856},{"_id":"source/_posts/2015-01-16-tai-ji-yin-yang-tu.markdown","hash":"602c47ac2899280ee07bdd4c07892be385179c0a","modified":1464945259857},{"_id":"source/_posts/2016-03-30-js拖拽实现.md","hash":"147b71f18759fed5551dfc6d454c84800b58c988","modified":1465009765972},{"_id":"source/_posts/2016-04-03-事件模型.md","hash":"fedbd9e8370e12931648d9432d6c0dec417cef6d","modified":1465009743943},{"_id":"source/_posts/2016-04-04-理解javascript中的this.md","hash":"3b3ceec379434a47c4724b679ef4fea210db8f70","modified":1465009733540},{"_id":"source/_posts/2016-04-21-函数柯里化(转).md","hash":"0a5190f0c1a22eb2f97b30cf096f58228925f6ec","modified":1465009616394},{"_id":"source/_posts/2016-04-21-原生ajax.md","hash":"8d9592363376cd9d401cfcf02586480fb5d7aedb","modified":1465009711656},{"_id":"source/_posts/2016-05-04-js依赖注入.md","hash":"4a6c225f4de484088b46b26441503d6d2977c8c1","modified":1465020198006},{"_id":"source/about/index.md","hash":"ac501895f76315106cd55d7d45dde1cab6a58db3","modified":1465020833504},{"_id":"source/tags/index.md","hash":"994955bc0baddbac61c24e61d679f597c8f51122","modified":1464945259859},{"_id":"themes/yelee/languages/default.yml","hash":"68bb7dab048ffc591d695a030c09ad904aff7c27","modified":1464945259939},{"_id":"themes/yelee/languages/en.yml","hash":"1f0c28d9f3cbf74361f372d2a0bdffa94d95a961","modified":1464945259939},{"_id":"themes/yelee/languages/zh-Hans.yml","hash":"34405ce3f6b99b990919795b3379c167ccad4d34","modified":1464945259940},{"_id":"themes/yelee/languages/zh-Hant-HK.yml","hash":"1f6f1b1f1a460e5bd282bdff26874461683a3bbe","modified":1464945259940},{"_id":"themes/yelee/languages/zh-Hant-TW.yml","hash":"04676d22558e1add668dbf78662acdfadb8cf3c5","modified":1464945259940},{"_id":"themes/yelee/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1464945259949},{"_id":"themes/yelee/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1464945259949},{"_id":"themes/yelee/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1464945259950},{"_id":"themes/yelee/layout/layout.ejs","hash":"bb7f9885bf858bfd1b0e92575a412617cdc7b309","modified":1464945259950},{"_id":"themes/yelee/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1464945259950},{"_id":"themes/yelee/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1464945259951},{"_id":"themes/yelee/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1464945259951},{"_id":"themes/yelee/source/apple-touch-icon.png","hash":"c0fda117fa166d63b9eb690cc5e4fb2caaf493b3","modified":1464945259952},{"_id":"themes/yelee/layout/_partial/after-footer.ejs","hash":"392108cdd1cd9a0e3eb98a583f5bd3b0ea386055","modified":1464945259941},{"_id":"themes/yelee/layout/_partial/archive-post.ejs","hash":"0ecc2ad07b4abad80f564ac1858c50bcbdff34f8","modified":1464945259942},{"_id":"themes/yelee/layout/_partial/archive.ejs","hash":"a4eacc2bc1278095a0ef99f904b0634c78f980eb","modified":1464945259942},{"_id":"themes/yelee/layout/_partial/article.ejs","hash":"e453440dc3ca068fe220809c2386742534bcf734","modified":1464945259942},{"_id":"themes/yelee/layout/_partial/background.ejs","hash":"aeef39abef66ee0bd6c9efe856eaeb1b81416d41","modified":1464945259943},{"_id":"themes/yelee/layout/_partial/footer.ejs","hash":"4cc5ed767999230dc337ba790e73e4e2c45104b5","modified":1464945259944},{"_id":"themes/yelee/layout/_partial/google-analytics.ejs","hash":"1ccc627d7697e68fddc367c73ac09920457e5b35","modified":1464945259944},{"_id":"themes/yelee/layout/_partial/head.ejs","hash":"9b87bc61f029c30bd3fa2112936639c7d913ee92","modified":1464945259945},{"_id":"themes/yelee/layout/_partial/header.ejs","hash":"b69855e07b65117769adc515cb64b803932068c9","modified":1464945259945},{"_id":"themes/yelee/layout/_partial/left-col.ejs","hash":"929416483de539cc0c94410d923258838b4c508b","modified":1464945259945},{"_id":"themes/yelee/layout/_partial/mobile-nav.ejs","hash":"8e14f5a3fb03d93ee2e5dcb0c26903f365518be1","modified":1464945259946},{"_id":"themes/yelee/layout/_partial/mathjax.ejs","hash":"e045f237b2434592be4d9a64ffab298bcf023be7","modified":1464945259946},{"_id":"themes/yelee/layout/_partial/page.ejs","hash":"e9bb15f7b3e3d7fbbbcac8df462584141f97bcd7","modified":1464945259946},{"_id":"themes/yelee/layout/_partial/post-nav-button.ejs","hash":"0a98bffdd14f6677721841c0ac4487a86c77266c","modified":1464945259947},{"_id":"themes/yelee/layout/_partial/scrolling-button.ejs","hash":"bfc245d99cca8e325f7c34b985a769ff780f28a6","modified":1464945259949},{"_id":"themes/yelee/layout/_partial/toc.ejs","hash":"de8774db289e973d71898b660e11a8f94a2674bd","modified":1464945259949},{"_id":"themes/yelee/source/background/bg-1.jpg","hash":"31d7bb15211000c05656899302f8ec9ee3de0e9f","modified":1464945259953},{"_id":"themes/yelee/source/background/bg-2.jpg","hash":"d1e0b92e8fa822e44d185b5e1bf94ab47bc98a0a","modified":1464945259963},{"_id":"themes/yelee/source/background/bg-4.jpg","hash":"9a5241de4c880f13a278f6980bf11d4dfb214d82","modified":1464945259966},{"_id":"themes/yelee/source/background/bg-3.jpg","hash":"7ae358f3ab8b41558444053400e796c41b3ba0e2","modified":1464945259964},{"_id":"themes/yelee/source/background/bg-5.jpg","hash":"d476909f06fe8267c676952e3582bf9e9ff73585","modified":1464945259968},{"_id":"themes/yelee/source/background/bg-6.jpg","hash":"6df1383d0f6134016d844df9abb740a6e0c0b2c5","modified":1464945259969},{"_id":"themes/yelee/source/background/bg-7.jpg","hash":"1a06d3a660bfb99b62d760e4e1e09de168a4c74c","modified":1464945259970},{"_id":"themes/yelee/source/background/bg-8.jpg","hash":"8e80d0b7786c3bf7b9648c0190719e78001e9eeb","modified":1464945259971},{"_id":"themes/yelee/source/css/_extend.styl","hash":"8ab1ad313bd6707d248c5ca1ee9a5eab8d815e42","modified":1464945259973},{"_id":"themes/yelee/source/css/_variables.styl","hash":"06102e525ff5722411ecc059da29ec1652d3ea4b","modified":1464945259980},{"_id":"themes/yelee/source/css/eventflow.css","hash":"2afab6e8db954541b8f438cfb325ac3ce96f3848","modified":1464957158450},{"_id":"themes/yelee/source/css/post_drag.css","hash":"6a8c0bcb50d76d016a6923101f8e30ef3aef5329","modified":1464945259981},{"_id":"themes/yelee/source/css/style.styl","hash":"c7e0461510b872b124fee10020ac7ee8da3c5a67","modified":1464945259981},{"_id":"themes/yelee/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1464945259982},{"_id":"themes/yelee/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1464945259982},{"_id":"themes/yelee/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1464945259982},{"_id":"themes/yelee/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1464945259983},{"_id":"themes/yelee/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1464945259983},{"_id":"themes/yelee/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1464945259984},{"_id":"themes/yelee/source/fancybox/jquery.fancybox.css","hash":"96138eaddfbd305160ddcb98a5f08555ca6cb4ee","modified":1464945259987},{"_id":"themes/yelee/source/fancybox/jquery.fancybox.js","hash":"004bb0812414554ab48067792f09e978603253b6","modified":1464945259987},{"_id":"themes/yelee/source/fancybox/jquery.fancybox.pack.js","hash":"2da892a02778236b64076e5e8802ef0566e1d9e8","modified":1464945259988},{"_id":"themes/yelee/source/img/GitHub.png","hash":"08c955a91b6733bd51913b54c69fe742d546d0ec","modified":1464945260039},{"_id":"themes/yelee/source/img/SegmentFault.png","hash":"52bd4ddf6df129b6958398b21fa370f17cadb428","modified":1464945260039},{"_id":"themes/yelee/source/img/TiddlyWiki.png","hash":"58be3c981c6d25b47ddaab2f254838f9baa01d59","modified":1464945260040},{"_id":"themes/yelee/source/img/V2EX.png","hash":"9adab6af95db9318e980c01cadbc5de800b4c816","modified":1464945260040},{"_id":"themes/yelee/source/img/avatar.png","hash":"13a34b1a297df3797a381b3d28287a2dfdd6499f","modified":1464945260052},{"_id":"themes/yelee/source/img/eventflow.png","hash":"014db00dc9533428ac87ba26784bb912304e89a2","modified":1464947347458},{"_id":"themes/yelee/source/img/eventflow.svg","hash":"c49141f75e224e038ad808655c369a190f11d1fb","modified":1464945715903},{"_id":"themes/yelee/source/img/img-err.png","hash":"23a63ea26eb3c1d5e677d9883cf36cc1a1a1228b","modified":1464945260053},{"_id":"themes/yelee/source/img/img-loading.png","hash":"a9cd5cd11866824f31e3d1c5e23badfeb3f73031","modified":1464945260053},{"_id":"themes/yelee/source/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1464945260054},{"_id":"themes/yelee/source/img/新浪微博.png","hash":"c9fb558158f491104fd8dbafc92c30591ad0299e","modified":1464945260054},{"_id":"themes/yelee/source/img/知乎.png","hash":"50e43bad8fefb3950b13dc86aaa86de8a79432ae","modified":1464945260055},{"_id":"themes/yelee/source/img/简书.png","hash":"bfe5e7b6146de19d180f36fa5a2b074c2bc23406","modified":1464945260056},{"_id":"themes/yelee/source/img/网易云音乐.png","hash":"8bc2a2e2c4312ee9d4879b24f9e2bd51e6436840","modified":1464945260056},{"_id":"themes/yelee/source/img/虾米音乐.png","hash":"d3ff836d5d58e10fb30fac1bae0aae34cfe2038f","modified":1464945260057},{"_id":"themes/yelee/source/img/豆瓣.png","hash":"9f4798298548727052fa6ae809933c9e8ac42571","modified":1464945260057},{"_id":"themes/yelee/source/js/GithubRepoWidget.js","hash":"5fb1bf6cf973062771ddf275ceeca5bc69c81c77","modified":1464945260058},{"_id":"themes/yelee/source/js/clipboard.min.js","hash":"fe53ec94d317bae8f12d1a5eee23040bf02680bb","modified":1464945260059},{"_id":"themes/yelee/source/js/eventflow.js","hash":"9a04b570e2bbaa7c363b962acfdd4336498fa259","modified":1464957200889},{"_id":"themes/yelee/source/js/instagram.js","hash":"81e13cacf4947118ed1920e59b04ccf6beef6b86","modified":1464945260059},{"_id":"themes/yelee/source/js/jquery.lazyload.js","hash":"91d5acc31d0bcbdf4782166a66344e58fff28d89","modified":1464945260060},{"_id":"themes/yelee/source/js/main.js","hash":"4fc2fd9ac5dd57e706f0ebb070e3ad2ca1191965","modified":1464945260061},{"_id":"themes/yelee/source/js/mobile.js","hash":"230339073c37202d953b2895856551d8ccb1b19a","modified":1464945260062},{"_id":"themes/yelee/source/js/particles.json","hash":"1fe70ffe28fd37aa87ff6d566ba678405e6a0e6c","modified":1464945260062},{"_id":"themes/yelee/source/js/particles.min.js","hash":"0828e491a4871d767b0f04ca33be81a09aafcfce","modified":1464945260063},{"_id":"themes/yelee/source/js/pc.js","hash":"c648ad0049c06395e42510b4f8559de7ae53ff53","modified":1464945260064},{"_id":"themes/yelee/source/js/post_drag.js","hash":"d192b613b30928c06dcf04ba6d6b4003ec82d037","modified":1464945260064},{"_id":"themes/yelee/source/background/bg-10.jpg","hash":"51b427f07ffc6f2ad97651f23cc16e8f19ed02f9","modified":1464945259955},{"_id":"themes/yelee/source/background/bg-9.jpg","hash":"e4a3631b6b0f94ebce30a6f01ecb2b6ed7cfdb0b","modified":1464945259972},{"_id":"themes/yelee/layout/_partial/comments/disqus.ejs","hash":"2e5cad68bc59190b4158f4ab1879a222ca49a0d2","modified":1464945259943},{"_id":"themes/yelee/layout/_partial/comments/duoshuo.ejs","hash":"1f9ac8182fe0b867a8f1988888336c40c25894cd","modified":1464945259944},{"_id":"themes/yelee/layout/_partial/comments/youyan.ejs","hash":"142e1bb357d738663655ddab25f75e85e20345e4","modified":1464945259944},{"_id":"themes/yelee/layout/_partial/post/date.ejs","hash":"a9fc6bac9e1b90c1c17c0d0ffd97f9b108072fbe","modified":1464945259947},{"_id":"themes/yelee/layout/_partial/post/nav.ejs","hash":"2a8d8198f6c8058bd0edc3d73c5df0833febf0f9","modified":1464945259948},{"_id":"themes/yelee/layout/_partial/post/category.ejs","hash":"08c8d98bc6a73d3f72a3b0b30521ff28e1b657a7","modified":1464945259947},{"_id":"themes/yelee/layout/_partial/post/share.ejs","hash":"bfac451ed8d632dbba84673691cc5ea3315c1469","modified":1464945259948},{"_id":"themes/yelee/layout/_partial/post/tag.ejs","hash":"7d2693a1162bf26e4b1ae9b789e0b2a2637ddbd5","modified":1464945259948},{"_id":"themes/yelee/layout/_partial/post/title.ejs","hash":"d4a460a35e2112d0c7414fd5e19b3a16093f1caf","modified":1464945259948},{"_id":"themes/yelee/source/css/_partial/archive.styl","hash":"053c1684b6edaca7fa0c94a7f9fca637ccece2c2","modified":1464945259973},{"_id":"themes/yelee/source/css/_partial/article.styl","hash":"21c532f24a2e90af158310e38060cf0e9ae62de0","modified":1464945259974},{"_id":"themes/yelee/source/css/_partial/footer.styl","hash":"2277125ef35f96a1ba76a1b84fc570526826453d","modified":1464945259976},{"_id":"themes/yelee/source/css/_partial/header.styl","hash":"67e59feb18eee6026717cb440d86ab9551782628","modified":1464945259976},{"_id":"themes/yelee/source/css/_partial/highlight.styl","hash":"6d535e646def5083e6c6e10a138a744d7d007c38","modified":1464945259977},{"_id":"themes/yelee/source/css/_partial/instagram.styl","hash":"a093443add2f529396d6b6bdef1675bc3acf3958","modified":1464945259977},{"_id":"themes/yelee/source/css/_partial/main.styl","hash":"5fb8fbc168974cf3e43bab0413e41c1ec0c345d3","modified":1464945259977},{"_id":"themes/yelee/source/css/_partial/mobile-slider.styl","hash":"211a4286f60751c372090fa96f384521e2ce352c","modified":1464945259978},{"_id":"themes/yelee/source/css/_partial/mobile.styl","hash":"8148239181328426b56fb8ebb54c17fb1aaa889a","modified":1464945259978},{"_id":"themes/yelee/source/css/_partial/page.styl","hash":"ca3f871adf8fdb296e4394070605dded53d93cb2","modified":1464945259978},{"_id":"themes/yelee/source/css/_partial/scroll.styl","hash":"f32deb9192568a2ea789d77a23a08d07f4e57d59","modified":1464945259979},{"_id":"themes/yelee/source/css/_partial/share.styl","hash":"3cfc59278c21b504f8f633e08767a449e03af8d0","modified":1464945259979},{"_id":"themes/yelee/source/css/_partial/tagcloud.styl","hash":"85540c10503e0fb250b307ca3966583ee70e63f3","modified":1464945259979},{"_id":"themes/yelee/source/css/_partial/wheelmenu.styl","hash":"9e57421eab562ea13d0ed2b2e1415eee79fa23d0","modified":1464945259980},{"_id":"themes/yelee/source/css/_util/grid.styl","hash":"1aa883ab432d9e4139c89dcbd40ae2bd1528d029","modified":1464945259980},{"_id":"themes/yelee/source/css/_util/mixin.styl","hash":"429bad87fc156eacf226c5e35b0eafc277f2504b","modified":1464945259980},{"_id":"themes/yelee/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1464945259984},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"4c9c395d705d22af7da06870d18f434e2a2eeaf9","modified":1464945259985},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"6394c48092085788a8c0ef72670b0652006231a1","modified":1464945259984},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-media.js","hash":"e14c32cc6823b81b2f758512f13ed8eb9ef2b454","modified":1464945259986},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"b88b589f5f1aa1b3d87cc7eef34c281ff749b1ae","modified":1464945259986},{"_id":"themes/yelee/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"83cdfea43632b613771691a11f56f99d85fb6dbd","modified":1464945259987},{"_id":"themes/yelee/source/font-awesome/css/font-awesome.css","hash":"6d39a08bc85169eca450978f895f85d5d3451c0a","modified":1464945259992},{"_id":"themes/yelee/source/font-awesome/css/font-awesome.min.css","hash":"624e4a106f0cf385ff4bd6a65c52cecd84f42ef9","modified":1464945259993},{"_id":"themes/yelee/source/font-awesome/fonts/FontAwesome.otf","hash":"42c179eef588854b5ec151bcf6a3f58aa8b79b11","modified":1464945259998},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.eot","hash":"986eed8dca049714e43eeebcb3932741a4bec76d","modified":1464945260026},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.woff","hash":"4a313eb93b959cc4154c684b915b0a31ddb68d84","modified":1464945260036},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.woff2","hash":"638c652d623280a58144f93e7b552c66d1667a11","modified":1464945260038},{"_id":"themes/yelee/source/css/_partial/customise/blockquote.styl","hash":"5d14ba8efac7a0f1ffd5bc8924fcfdb7294bc918","modified":1464945259974},{"_id":"themes/yelee/source/css/_partial/customise/code-block.styl","hash":"4db1a992a06fd92b779f0afc9bb8bb3667bdb101","modified":1464945259975},{"_id":"themes/yelee/source/css/_partial/customise/color-scheme.styl","hash":"69a77b9f7b8e84df7ae1c78e76659a92739b79a9","modified":1464945259975},{"_id":"themes/yelee/source/css/_partial/customise/inline-code.styl","hash":"aedbcd697c9fbaeeb93c068be3db771c41feba0d","modified":1464945259975},{"_id":"themes/yelee/source/css/_partial/customise/social-icon.styl","hash":"2f3e9c3a08c7693ba1787db0c4af8a3fd98d696a","modified":1464945259976},{"_id":"themes/yelee/source/css/_partial/post/youyan.styl","hash":"9076b0d3c231e16b8a1d7f834e62a98d843edd32","modified":1464945259978},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.ttf","hash":"6484f1af6b485d5096b71b344e67f4164c33dd1f","modified":1464945260033},{"_id":"themes/yelee/source/font-awesome/fonts/fontawesome-webfont.svg","hash":"550ef5c1253c8376f2ead32b654eb58d3c106ca3","modified":1464945260030}],"Category":[],"Data":[],"Page":[{"title":"about","date":"2016-03-28T06:47:54.000Z","_content":"还没想好要说什么","source":"about/index.md","raw":"---\ntitle: about\ndate: 2016-03-28 14:47:54\n---\n还没想好要说什么","updated":"2016-06-04T06:13:53.504Z","path":"about/index.html","comments":1,"layout":"page","_id":"cip0rl5m700013ocgxvc0itej","content":"<p>还没想好要说什么</p>\n","excerpt":"","more":"<p>还没想好要说什么</p>\n"},{"title":"tags","date":"2016-03-28T06:48:07.000Z","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2016-03-28 14:48:07\n---\n","updated":"2016-06-03T09:14:19.859Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cip0rl5md00033ocgv2kfind4","content":"","excerpt":"","more":""}],"Post":[{"layout":"post","title":"my first blog","date":"2015-01-15T07:29:07.000Z","comments":1,"_content":"I need to start learning Ruby\n","source":"_posts/2015-01-15-my-first-blog.markdown","raw":"---\nlayout: post\ntitle: \"my first blog\"\ndate: 2015-01-15 15:29:07 +0800\ncomments: true\ncategories:\n---\nI need to start learning Ruby\n","slug":"my-first-blog","published":1,"updated":"2016-06-03T09:14:19.855Z","photos":[],"link":"","_id":"cip0rl5m100003ocgt1z4j9ub","content":"<p>I need to start learning Ruby</p>\n","excerpt":"","more":"<p>I need to start learning Ruby</p>\n"},{"layout":"post","title":"css3Clock","date":"2015-01-16T10:50:56.000Z","comments":1,"_content":"reference http://segmentfault.com/a/1190000003055672\n\n<p data-height=\"400\" data-theme-id=\"0\" data-slug-hash=\"MKKXJp\" data-default-tab=\"result\" data-user=\"HughDai\" class='codepen'>See the Pen <a href='http://codepen.io/HughDai/pen/MKKXJp/'>clock</a> by Hugh Dai (<a href='http://codepen.io/HughDai'>@HughDai</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n","source":"_posts/2015-01-16-css3clock.markdown","raw":"---\nlayout: post\ntitle: \"css3Clock\"\ndate: 2015-01-16 18:50:56 +0800\ncomments: true\ncategories:\n---\nreference http://segmentfault.com/a/1190000003055672\n\n<p data-height=\"400\" data-theme-id=\"0\" data-slug-hash=\"MKKXJp\" data-default-tab=\"result\" data-user=\"HughDai\" class='codepen'>See the Pen <a href='http://codepen.io/HughDai/pen/MKKXJp/'>clock</a> by Hugh Dai (<a href='http://codepen.io/HughDai'>@HughDai</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n","slug":"css3clock","published":1,"updated":"2016-06-03T09:14:19.856Z","photos":[],"link":"","_id":"cip0rl5m900023ocg2x6phhdn","content":"<p>reference <a href=\"http://segmentfault.com/a/1190000003055672\" target=\"_blank\" rel=\"external\">http://segmentfault.com/a/1190000003055672</a></p>\n<p></p><p data-height=\"400\" data-theme-id=\"0\" data-slug-hash=\"MKKXJp\" data-default-tab=\"result\" data-user=\"HughDai\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/HughDai/pen/MKKXJp/\" target=\"_blank\" rel=\"external\">clock</a> by Hugh Dai (<a href=\"http://codepen.io/HughDai\" target=\"_blank\" rel=\"external\">@HughDai</a>) on <a href=\"http://codepen.io\" target=\"_blank\" rel=\"external\">CodePen</a>.</p><p></p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n","excerpt":"","more":"<p>reference <a href=\"http://segmentfault.com/a/1190000003055672\">http://segmentfault.com/a/1190000003055672</a></p>\n<p><p data-height=\"400\" data-theme-id=\"0\" data-slug-hash=\"MKKXJp\" data-default-tab=\"result\" data-user=\"HughDai\" class='codepen'>See the Pen <a href='http://codepen.io/HughDai/pen/MKKXJp/'>clock</a> by Hugh Dai (<a href='http://codepen.io/HughDai'>@HughDai</a>) on <a href='http://codepen.io'>CodePen</a>.</p></p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n"},{"layout":"post","title":"太极阴阳图","date":"2015-01-16T06:33:26.000Z","comments":1,"_content":"<p data-height=\"300\" data-theme-id=\"0\" data-slug-hash=\"XXXZeV\" data-default-tab=\"result\" data-user=\"HughDai\" class='codepen'>See the Pen <a href='http://codepen.io/HughDai/pen/XXXZeV/'>XXXZeV</a> by Hugh Dai (<a href='http://codepen.io/HughDai'>@HughDai</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n","source":"_posts/2015-01-16-tai-ji-yin-yang-tu.markdown","raw":"---\nlayout: post\ntitle: \"太极阴阳图\"\ndate: 2015-01-16 14:33:26 +0800\ncomments: true\ncategories:\n---\n<p data-height=\"300\" data-theme-id=\"0\" data-slug-hash=\"XXXZeV\" data-default-tab=\"result\" data-user=\"HughDai\" class='codepen'>See the Pen <a href='http://codepen.io/HughDai/pen/XXXZeV/'>XXXZeV</a> by Hugh Dai (<a href='http://codepen.io/HughDai'>@HughDai</a>) on <a href='http://codepen.io'>CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n","slug":"tai-ji-yin-yang-tu","published":1,"updated":"2016-06-03T09:14:19.857Z","photos":[],"link":"","_id":"cip0rl5mf00043ocg5dmrswmq","content":"<p></p><p data-height=\"300\" data-theme-id=\"0\" data-slug-hash=\"XXXZeV\" data-default-tab=\"result\" data-user=\"HughDai\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/HughDai/pen/XXXZeV/\" target=\"_blank\" rel=\"external\">XXXZeV</a> by Hugh Dai (<a href=\"http://codepen.io/HughDai\" target=\"_blank\" rel=\"external\">@HughDai</a>) on <a href=\"http://codepen.io\" target=\"_blank\" rel=\"external\">CodePen</a>.</p><p></p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n","excerpt":"","more":"<p><p data-height=\"300\" data-theme-id=\"0\" data-slug-hash=\"XXXZeV\" data-default-tab=\"result\" data-user=\"HughDai\" class='codepen'>See the Pen <a href='http://codepen.io/HughDai/pen/XXXZeV/'>XXXZeV</a> by Hugh Dai (<a href='http://codepen.io/HughDai'>@HughDai</a>) on <a href='http://codepen.io'>CodePen</a>.</p></p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>\n"},{"title":"原生js拖拽实现","date":"2016-03-30T06:56:37.000Z","_content":"## 实现分析\n&emsp;&emsp;最近为了应付面试，浏览了许多js知识点，试着用原生js实现拖拽效果，鼠标拖动效果很常见，像是百度首页的登录框就是经典案例，究其原因无非就是鼠标的三个事件：mousedown、mousemove和mouseup。\n## 原理分析\n1. 鼠标按下时即mousedown，记录mousedown值为true，此时记录下当前鼠标的坐标以及要拖动元素的坐标\n2. 鼠标按下并移动即mousemove，记录下即时的鼠标新坐标，鼠标新旧坐标相减再加上第一步得到的元素坐标即为新的拖拽元素坐标，也就是拖拽坐标跟随鼠标移动。\n3. 鼠标松开时即mouseup，把鼠标状态mousedown设为false。\n## 代码\n### html\n    ```html\n    <div id=\"dialog\">\n       <div id='drag'>\n           <div id=\"title\">我是title,拖动我试一下</div>\n           <div id=\"content\">我是content，拖动我无效</div>\n       </div>\n   </div>\n    ```\n### css\n    ```css\n    #wrapper {\n       position: relative;\n       height:500px;\n       width:100%;\n       border:1px solid red;\n   }\n   \n   #dialog {\n       position: absolute;\n       width: 300px;\n       height: 200px;\n       padding: 5px;\n       top: 50px;\n       left: 50px;\n       background-color: #d9e1ed;\n       box-shadow: 2px 2px 2px #5c5d6c;\n       border-radius: 5px;\n   }\n   \n   #drag {\n       border: 1px solid rgb(217, 217, 217);\n       background-color: white;\n   }\n   \n   #title {\n       background-color: rgba(198, 232, 255, 0.43);\n       border-bottom: 1px solid rgb(217, 217, 217);\n       cursor: move;\n   }\n   \n   #content {\n       padding: 5px;\n       height: 165px;\n   }\n    ```\n    \n### js\n\n    ``` javascript\n    /**\n    * Created by hughdai on 16/3/30.\n    */\n   //事件处理\n   var EventCtrl = {\n       addEvent: function (ele, type, fn) {\n           if (ele.addEventListener) {\n               ele.addEventListener(type, fn, false);\n           }\n           else {\n               ele.attachEvent('on' + type, fn);\n           }\n       },\n       removeEvent: function (ele, type, fn) {\n           if (ele.removeEventListener) {\n               ele.removeEventListener(type, fn, false);\n           }\n           else {\n               ele.detachEvent('on' + type, fn);\n           }\n       }\n   }\n   //获取元素样式\n   function getStyle(ele, style) {\n       if (getComputedStyle) {\n           return getComputedStyle(ele, false)[style];\n       }\n       else {\n           return ele.currentStyle[style];\n       }\n   }\n   function drag() {\n       var x = 0, y = 0, top = 0, left = 0;\n       var mouseDown = false;\n       var dialog = document.getElementById('dialog');\n       EventCtrl.addEvent(this, 'mousedown', function (event) {\n           mouseDown = true;\n           this.onselectstart = function () {\n               return false;\n           };\n           var e = event || window.event;\n           left = parseInt(getStyle(dialog, 'left'));//记录当前元素偏移\n           top = parseInt(getStyle(dialog, 'top'));\n           x = parseInt(e.clientX || e.x);//记录当前鼠标位置\n           y = parseInt(e.clientY || e.y);\n       })\n   \n       EventCtrl.addEvent(document, 'mousemove', function (event) {\n           if (mouseDown) {\n               var e = event || window.event;\n               var container = document.getElementById('wrapper')\n               var currentX = parseInt(e.clientX || e.x);//当前鼠标位置\n               var currentY = parseInt(e.clientY || e.y);\n               var displayX = currentX - x + left;//新鼠标位置减去旧鼠标位置加上元素偏移\n               var displayY = currentY - y + top;\n               var width = container.offsetWidth - dialog.offsetWidth;\n               var height = container.offsetHeight - dialog.offsetHeight;\n               console.log('displayX:' + displayX, 'displayY:' + displayY);\n               //限制元素不被拖出容器范围\n               if (displayX < 0) {\n                   displayX = 0\n               }\n               else if (displayX > width) {\n                   displayX = width\n               }\n               if (displayY < 0) {\n                   displayY = 0\n               }\n               else if (displayY > height) {\n                   displayY = height\n               }\n               dialog.style.left = displayX + 'px';\n               dialog.style.top = displayY + 'px';\n           }\n       })\n   \n       EventCtrl.addEvent(document, 'mouseup', function (event) {\n           mouseDown = false;\n           left = parseInt(getStyle(dialog, 'left'));\n           top = parseInt(getStyle(dialog, 'top'));\n           EventCtrl.removeEvent(document, 'mousemove', function () {\n   \n           })\n           EventCtrl.removeEvent(document, 'mouseup', function () {\n   \n           })\n       })\n   }\n   document.addEventListener('DOMContentLoaded', function () {\n       drag.call(document.getElementById('title'));\n   }, false)\n    ```\n\n## 效果\n\n<link rel=\"stylesheet\" href=\"/css/post_drag.css\"/>\n<div id=\"wrapper\"><div id=\"dialog\"><div id='drag'><div id=\"title\">我是title,拖动我试一下</div><div id=\"content\">我是content，拖动我无效</div></div></div></div>\n<script src='/js/post_drag.js'></script>\n","source":"_posts/2016-03-30-js拖拽实现.md","raw":"---\ntitle: 原生js拖拽实现\ndate: 2016-03-30 14:56:37\ntags: \n---\n## 实现分析\n&emsp;&emsp;最近为了应付面试，浏览了许多js知识点，试着用原生js实现拖拽效果，鼠标拖动效果很常见，像是百度首页的登录框就是经典案例，究其原因无非就是鼠标的三个事件：mousedown、mousemove和mouseup。\n## 原理分析\n1. 鼠标按下时即mousedown，记录mousedown值为true，此时记录下当前鼠标的坐标以及要拖动元素的坐标\n2. 鼠标按下并移动即mousemove，记录下即时的鼠标新坐标，鼠标新旧坐标相减再加上第一步得到的元素坐标即为新的拖拽元素坐标，也就是拖拽坐标跟随鼠标移动。\n3. 鼠标松开时即mouseup，把鼠标状态mousedown设为false。\n## 代码\n### html\n    ```html\n    <div id=\"dialog\">\n       <div id='drag'>\n           <div id=\"title\">我是title,拖动我试一下</div>\n           <div id=\"content\">我是content，拖动我无效</div>\n       </div>\n   </div>\n    ```\n### css\n    ```css\n    #wrapper {\n       position: relative;\n       height:500px;\n       width:100%;\n       border:1px solid red;\n   }\n   \n   #dialog {\n       position: absolute;\n       width: 300px;\n       height: 200px;\n       padding: 5px;\n       top: 50px;\n       left: 50px;\n       background-color: #d9e1ed;\n       box-shadow: 2px 2px 2px #5c5d6c;\n       border-radius: 5px;\n   }\n   \n   #drag {\n       border: 1px solid rgb(217, 217, 217);\n       background-color: white;\n   }\n   \n   #title {\n       background-color: rgba(198, 232, 255, 0.43);\n       border-bottom: 1px solid rgb(217, 217, 217);\n       cursor: move;\n   }\n   \n   #content {\n       padding: 5px;\n       height: 165px;\n   }\n    ```\n    \n### js\n\n    ``` javascript\n    /**\n    * Created by hughdai on 16/3/30.\n    */\n   //事件处理\n   var EventCtrl = {\n       addEvent: function (ele, type, fn) {\n           if (ele.addEventListener) {\n               ele.addEventListener(type, fn, false);\n           }\n           else {\n               ele.attachEvent('on' + type, fn);\n           }\n       },\n       removeEvent: function (ele, type, fn) {\n           if (ele.removeEventListener) {\n               ele.removeEventListener(type, fn, false);\n           }\n           else {\n               ele.detachEvent('on' + type, fn);\n           }\n       }\n   }\n   //获取元素样式\n   function getStyle(ele, style) {\n       if (getComputedStyle) {\n           return getComputedStyle(ele, false)[style];\n       }\n       else {\n           return ele.currentStyle[style];\n       }\n   }\n   function drag() {\n       var x = 0, y = 0, top = 0, left = 0;\n       var mouseDown = false;\n       var dialog = document.getElementById('dialog');\n       EventCtrl.addEvent(this, 'mousedown', function (event) {\n           mouseDown = true;\n           this.onselectstart = function () {\n               return false;\n           };\n           var e = event || window.event;\n           left = parseInt(getStyle(dialog, 'left'));//记录当前元素偏移\n           top = parseInt(getStyle(dialog, 'top'));\n           x = parseInt(e.clientX || e.x);//记录当前鼠标位置\n           y = parseInt(e.clientY || e.y);\n       })\n   \n       EventCtrl.addEvent(document, 'mousemove', function (event) {\n           if (mouseDown) {\n               var e = event || window.event;\n               var container = document.getElementById('wrapper')\n               var currentX = parseInt(e.clientX || e.x);//当前鼠标位置\n               var currentY = parseInt(e.clientY || e.y);\n               var displayX = currentX - x + left;//新鼠标位置减去旧鼠标位置加上元素偏移\n               var displayY = currentY - y + top;\n               var width = container.offsetWidth - dialog.offsetWidth;\n               var height = container.offsetHeight - dialog.offsetHeight;\n               console.log('displayX:' + displayX, 'displayY:' + displayY);\n               //限制元素不被拖出容器范围\n               if (displayX < 0) {\n                   displayX = 0\n               }\n               else if (displayX > width) {\n                   displayX = width\n               }\n               if (displayY < 0) {\n                   displayY = 0\n               }\n               else if (displayY > height) {\n                   displayY = height\n               }\n               dialog.style.left = displayX + 'px';\n               dialog.style.top = displayY + 'px';\n           }\n       })\n   \n       EventCtrl.addEvent(document, 'mouseup', function (event) {\n           mouseDown = false;\n           left = parseInt(getStyle(dialog, 'left'));\n           top = parseInt(getStyle(dialog, 'top'));\n           EventCtrl.removeEvent(document, 'mousemove', function () {\n   \n           })\n           EventCtrl.removeEvent(document, 'mouseup', function () {\n   \n           })\n       })\n   }\n   document.addEventListener('DOMContentLoaded', function () {\n       drag.call(document.getElementById('title'));\n   }, false)\n    ```\n\n## 效果\n\n<link rel=\"stylesheet\" href=\"/css/post_drag.css\"/>\n<div id=\"wrapper\"><div id=\"dialog\"><div id='drag'><div id=\"title\">我是title,拖动我试一下</div><div id=\"content\">我是content，拖动我无效</div></div></div></div>\n<script src='/js/post_drag.js'></script>\n","slug":"js拖拽实现","published":1,"updated":"2016-06-04T03:09:25.972Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cip0rl5mi00053ocg6ys9yske","content":"<h2 id=\"实现分析\"><a href=\"#实现分析\" class=\"headerlink\" title=\"实现分析\"></a>实现分析</h2><p>&emsp;&emsp;最近为了应付面试，浏览了许多js知识点，试着用原生js实现拖拽效果，鼠标拖动效果很常见，像是百度首页的登录框就是经典案例，究其原因无非就是鼠标的三个事件：mousedown、mousemove和mouseup。</p>\n<h2 id=\"原理分析\"><a href=\"#原理分析\" class=\"headerlink\" title=\"原理分析\"></a>原理分析</h2><ol>\n<li>鼠标按下时即mousedown，记录mousedown值为true，此时记录下当前鼠标的坐标以及要拖动元素的坐标</li>\n<li>鼠标按下并移动即mousemove，记录下即时的鼠标新坐标，鼠标新旧坐标相减再加上第一步得到的元素坐标即为新的拖拽元素坐标，也就是拖拽坐标跟随鼠标移动。</li>\n<li>鼠标松开时即mouseup，把鼠标状态mousedown设为false。<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><h3 id=\"html\"><a href=\"#html\" class=\"headerlink\" title=\"html\"></a>html</h3> <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"dialog\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">'drag'</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"title\"</span>&gt;</span>我是title,拖动我试一下<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"content\"</span>&gt;</span>我是content，拖动我无效<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"css\"><a href=\"#css\" class=\"headerlink\" title=\"css\"></a>css</h3><pre><code><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"selector-id\">#wrapper</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>:<span class=\"number\">500px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>:<span class=\"number\">100%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>:<span class=\"number\">1px</span> solid red;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#dialog</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"number\">#d9e1ed</span>;</span><br><span class=\"line\">    <span class=\"attribute\">box-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">#5c5d6c</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#drag</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"built_in\">rgb</span>(217, 217, 217);</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: white;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#title</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(198, 232, 255, 0.43);</span><br><span class=\"line\">    <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"built_in\">rgb</span>(217, 217, 217);</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: move;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#content</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">165px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</code></pre><h3 id=\"js\"><a href=\"#js\" class=\"headerlink\" title=\"js\"></a>js</h3><pre><code><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span><br><span class=\"line\"> * Created by hughdai on 16/3/30.</span><br><span class=\"line\"> */</span></span><br><span class=\"line\"><span class=\"comment\">//事件处理</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> EventCtrl = &#123;</span><br><span class=\"line\">    addEvent: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">ele, type, fn</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ele.addEventListener) &#123;</span><br><span class=\"line\">            ele.addEventListener(type, fn, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            ele.attachEvent(<span class=\"string\">'on'</span> + type, fn);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    removeEvent: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">ele, type, fn</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ele.removeEventListener) &#123;</span><br><span class=\"line\">            ele.removeEventListener(type, fn, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            ele.detachEvent(<span class=\"string\">'on'</span> + type, fn);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//获取元素样式</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getStyle</span>(<span class=\"params\">ele, style</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (getComputedStyle) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getComputedStyle(ele, <span class=\"literal\">false</span>)[style];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ele.currentStyle[style];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drag</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> x = <span class=\"number\">0</span>, y = <span class=\"number\">0</span>, top = <span class=\"number\">0</span>, left = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> mouseDown = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> dialog = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'dialog'</span>);</span><br><span class=\"line\">    EventCtrl.addEvent(<span class=\"keyword\">this</span>, <span class=\"string\">'mousedown'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">        mouseDown = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onselectstart = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> e = event || <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">        left = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'left'</span>));<span class=\"comment\">//记录当前元素偏移</span></span><br><span class=\"line\">        top = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'top'</span>));</span><br><span class=\"line\">        x = <span class=\"built_in\">parseInt</span>(e.clientX || e.x);<span class=\"comment\">//记录当前鼠标位置</span></span><br><span class=\"line\">        y = <span class=\"built_in\">parseInt</span>(e.clientY || e.y);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    EventCtrl.addEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mousemove'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mouseDown) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> e = event || <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> container = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'wrapper'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">var</span> currentX = <span class=\"built_in\">parseInt</span>(e.clientX || e.x);<span class=\"comment\">//当前鼠标位置</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> currentY = <span class=\"built_in\">parseInt</span>(e.clientY || e.y);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> displayX = currentX - x + left;<span class=\"comment\">//新鼠标位置减去旧鼠标位置加上元素偏移</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> displayY = currentY - y + top;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> width = container.offsetWidth - dialog.offsetWidth;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> height = container.offsetHeight - dialog.offsetHeight;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'displayX:'</span> + displayX, <span class=\"string\">'displayY:'</span> + displayY);</span><br><span class=\"line\">            <span class=\"comment\">//限制元素不被拖出容器范围</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (displayX &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                displayX = <span class=\"number\">0</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (displayX &gt; width) &#123;</span><br><span class=\"line\">                displayX = width</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (displayY &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                displayY = <span class=\"number\">0</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (displayY &gt; height) &#123;</span><br><span class=\"line\">                displayY = height</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            dialog.style.left = displayX + <span class=\"string\">'px'</span>;</span><br><span class=\"line\">            dialog.style.top = displayY + <span class=\"string\">'px'</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    EventCtrl.addEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mouseup'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">        mouseDown = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        left = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'left'</span>));</span><br><span class=\"line\">        top = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'top'</span>));</span><br><span class=\"line\">        EventCtrl.removeEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mousemove'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        EventCtrl.removeEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mouseup'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'DOMContentLoaded'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    drag.call(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'title'</span>));</span><br><span class=\"line\">&#125;, <span class=\"literal\">false</span>)</span><br></pre></td></tr></table></figure>\n</code></pre><h2 id=\"效果\"><a href=\"#效果\" class=\"headerlink\" title=\"效果\"></a>效果</h2><p><link rel=\"stylesheet\" href=\"/css/post_drag.css\"></p>\n<p><div id=\"wrapper\"><div id=\"dialog\"><div id=\"drag\"><div id=\"title\">我是title,拖动我试一下</div><div id=\"content\">我是content，拖动我无效</div></div></div></div></p>\n<script src=\"/js/post_drag.js\"></script>\n","excerpt":"","more":"<h2 id=\"实现分析\"><a href=\"#实现分析\" class=\"headerlink\" title=\"实现分析\"></a>实现分析</h2><p>&emsp;&emsp;最近为了应付面试，浏览了许多js知识点，试着用原生js实现拖拽效果，鼠标拖动效果很常见，像是百度首页的登录框就是经典案例，究其原因无非就是鼠标的三个事件：mousedown、mousemove和mouseup。</p>\n<h2 id=\"原理分析\"><a href=\"#原理分析\" class=\"headerlink\" title=\"原理分析\"></a>原理分析</h2><ol>\n<li>鼠标按下时即mousedown，记录mousedown值为true，此时记录下当前鼠标的坐标以及要拖动元素的坐标</li>\n<li>鼠标按下并移动即mousemove，记录下即时的鼠标新坐标，鼠标新旧坐标相减再加上第一步得到的元素坐标即为新的拖拽元素坐标，也就是拖拽坐标跟随鼠标移动。</li>\n<li>鼠标松开时即mouseup，把鼠标状态mousedown设为false。<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><h3 id=\"html\"><a href=\"#html\" class=\"headerlink\" title=\"html\"></a>html</h3> <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"dialog\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">'drag'</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"title\"</span>&gt;</span>我是title,拖动我试一下<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"content\"</span>&gt;</span>我是content，拖动我无效<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"css\"><a href=\"#css\" class=\"headerlink\" title=\"css\"></a>css</h3><pre><code><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"selector-id\">#wrapper</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>:<span class=\"number\">500px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>:<span class=\"number\">100%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>:<span class=\"number\">1px</span> solid red;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#dialog</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: absolute;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"number\">#d9e1ed</span>;</span><br><span class=\"line\">    <span class=\"attribute\">box-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">#5c5d6c</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#drag</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"built_in\">rgb</span>(217, 217, 217);</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: white;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#title</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(198, 232, 255, 0.43);</span><br><span class=\"line\">    <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"built_in\">rgb</span>(217, 217, 217);</span><br><span class=\"line\">    <span class=\"attribute\">cursor</span>: move;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#content</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">165px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</code></pre><h3 id=\"js\"><a href=\"#js\" class=\"headerlink\" title=\"js\"></a>js</h3><pre><code><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span><br><span class=\"line\"> * Created by hughdai on 16/3/30.</span><br><span class=\"line\"> */</span></span><br><span class=\"line\"><span class=\"comment\">//事件处理</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> EventCtrl = &#123;</span><br><span class=\"line\">    addEvent: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">ele, type, fn</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ele.addEventListener) &#123;</span><br><span class=\"line\">            ele.addEventListener(type, fn, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            ele.attachEvent(<span class=\"string\">'on'</span> + type, fn);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    removeEvent: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">ele, type, fn</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ele.removeEventListener) &#123;</span><br><span class=\"line\">            ele.removeEventListener(type, fn, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            ele.detachEvent(<span class=\"string\">'on'</span> + type, fn);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//获取元素样式</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getStyle</span>(<span class=\"params\">ele, style</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (getComputedStyle) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getComputedStyle(ele, <span class=\"literal\">false</span>)[style];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ele.currentStyle[style];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">drag</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> x = <span class=\"number\">0</span>, y = <span class=\"number\">0</span>, top = <span class=\"number\">0</span>, left = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> mouseDown = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> dialog = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'dialog'</span>);</span><br><span class=\"line\">    EventCtrl.addEvent(<span class=\"keyword\">this</span>, <span class=\"string\">'mousedown'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">        mouseDown = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onselectstart = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> e = event || <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">        left = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'left'</span>));<span class=\"comment\">//记录当前元素偏移</span></span><br><span class=\"line\">        top = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'top'</span>));</span><br><span class=\"line\">        x = <span class=\"built_in\">parseInt</span>(e.clientX || e.x);<span class=\"comment\">//记录当前鼠标位置</span></span><br><span class=\"line\">        y = <span class=\"built_in\">parseInt</span>(e.clientY || e.y);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    EventCtrl.addEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mousemove'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mouseDown) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> e = event || <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> container = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'wrapper'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">var</span> currentX = <span class=\"built_in\">parseInt</span>(e.clientX || e.x);<span class=\"comment\">//当前鼠标位置</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> currentY = <span class=\"built_in\">parseInt</span>(e.clientY || e.y);</span><br><span class=\"line\">            <span class=\"keyword\">var</span> displayX = currentX - x + left;<span class=\"comment\">//新鼠标位置减去旧鼠标位置加上元素偏移</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> displayY = currentY - y + top;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> width = container.offsetWidth - dialog.offsetWidth;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> height = container.offsetHeight - dialog.offsetHeight;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'displayX:'</span> + displayX, <span class=\"string\">'displayY:'</span> + displayY);</span><br><span class=\"line\">            <span class=\"comment\">//限制元素不被拖出容器范围</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (displayX &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                displayX = <span class=\"number\">0</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (displayX &gt; width) &#123;</span><br><span class=\"line\">                displayX = width</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (displayY &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                displayY = <span class=\"number\">0</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (displayY &gt; height) &#123;</span><br><span class=\"line\">                displayY = height</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            dialog.style.left = displayX + <span class=\"string\">'px'</span>;</span><br><span class=\"line\">            dialog.style.top = displayY + <span class=\"string\">'px'</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    EventCtrl.addEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mouseup'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">        mouseDown = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        left = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'left'</span>));</span><br><span class=\"line\">        top = <span class=\"built_in\">parseInt</span>(getStyle(dialog, <span class=\"string\">'top'</span>));</span><br><span class=\"line\">        EventCtrl.removeEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mousemove'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        EventCtrl.removeEvent(<span class=\"built_in\">document</span>, <span class=\"string\">'mouseup'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'DOMContentLoaded'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    drag.call(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'title'</span>));</span><br><span class=\"line\">&#125;, <span class=\"literal\">false</span>)</span><br></pre></td></tr></table></figure>\n</code></pre><h2 id=\"效果\"><a href=\"#效果\" class=\"headerlink\" title=\"效果\"></a>效果</h2><p><link rel=\"stylesheet\" href=\"/css/post_drag.css\"/></p>\n<p><div id=\"wrapper\"><div id=\"dialog\"><div id='drag'><div id=\"title\">我是title,拖动我试一下</div><div id=\"content\">我是content，拖动我无效</div></div></div></div></p>\n<script src='/js/post_drag.js'></script>\n"},{"title":"事件模型","date":"2016-04-03T09:27:16.000Z","_content":"## 事件触发过程\n在前端开发中，经常会遇到事件监听，很多人对事件捕获及事件冒泡不置可否，以下是我对事件模型的一些看法，简单来说就是从外向内捕捉，然后到目标阶段后依次向上冒泡，详情请自行[W3C](https://www.w3.org/TR/DOM-Level-3-Events/#event-flow)。\n图片引用自[W3C](https://www.w3.org/TR/DOM-Level-3-Events/#event-flow)\n![](/img/eventflow.png)\n    1、捕获阶段：在事件对象到达事件目标之前，事件对象必须从window经过目标的祖先节点传播到事件目标。 这个阶段被我们称之为捕获阶段。在这个阶段注册的事件监听器在事件到达其目标前必须先处理事件。\n    2、目标阶段：事件对象到达其事件目标。 这个阶段被我们称为目标阶段。一旦事件对象到达事件目标，该阶段的事件监听器就要对它进行处理。如果一个事件对象类型被标志为不能冒泡。那么对应的事件对象在到达此阶段时就会终止传播。\n    3、冒泡阶段：事件对象以一个与捕获阶段相反的方向从事件目标传播经过其祖先节点传播到window。这个阶段被称之为冒泡阶段。在此阶段注册的事件监听器会对相应的冒泡事件进行处理。\n## 跨浏览器EventUtil\n以下是js大神[Nicholas Zakas](https://github.com/nzakas/)写的[Professional JavaScript for Web Developers](https://www.amazon.cn/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1-%E6%B3%BD%E5%8D%A1%E6%96%AF/dp/B007OQQVMY)中的Cross Browser Event Utility\n查看[Hugh Dai Gist](https://gist.github.com/HughDai/a365e2515643e861ceff6b6181400449)\n```javascript\n    var EventUtil = {\n                addHandler: function( element, type, handler ) {\n                    if ( element.addEventListener ) {\n                        element.addEventListener ( type, handler, false );\n                    } else if ( element.attachEvent ) {\n                        element.attachEvent ( \"on\" + type, handler );\n                    } else {\n                        element[\"on\" + type] = handler;\n                    }\n                },\n                getEvent: function ( event ) {\n                    return event ? event : window.event;\n                },\n                getTarget: function ( event ) {\n                    return event.target || event.srcElement;\n                },\n                preventDefault: function ( event ) {\n                    if ( event.preventDefault ) {\n                        event.preventDefault();\n                    } else {\n                        event.returnValue = false;\n                    }\n                },\n                removeHandler: function( element, type, handler ) {\n                    if ( element.removeEventListener ) {\n                        element.removeEventListener ( type, handler, false );\n                    } else if ( element.detachEvent ) {\n                        element.detachEvent ( \"on\" + type, handler );\n                    } else {\n                        element[\"on\" + type] = null;\n                    }\n                },\n                stopPropagation: function ( event ) {\n                    if ( event.stopPropagation ) {\n                        event.stopPropagation();\n                    } else {\n                        event.cancelBubble = true;\n                    }\n                }\n            };\n```\n\n## Demo\n这里修改一下大神[Wilson Page](https://github.com/wilsonpage)的一个demo，更形象的描述事件流模型。\n\n<p data-height=\"600\" data-theme-id=\"0\" data-slug-hash=\"BzNjax\" data-default-tab=\"js,result\" data-user=\"HughDai\" data-embed-version=\"2\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/HughDai/pen/BzNjax/\">BzNjax</a> by Hugh Dai (<a href=\"http://codepen.io/HughDai\">@HughDai</a>) on <a href=\"http://codepen.io\">CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>","source":"_posts/2016-04-03-事件模型.md","raw":"---\ntitle: 事件模型\ndate: 2016-04-03 17:27:16\ntags:\n---\n## 事件触发过程\n在前端开发中，经常会遇到事件监听，很多人对事件捕获及事件冒泡不置可否，以下是我对事件模型的一些看法，简单来说就是从外向内捕捉，然后到目标阶段后依次向上冒泡，详情请自行[W3C](https://www.w3.org/TR/DOM-Level-3-Events/#event-flow)。\n图片引用自[W3C](https://www.w3.org/TR/DOM-Level-3-Events/#event-flow)\n![](/img/eventflow.png)\n    1、捕获阶段：在事件对象到达事件目标之前，事件对象必须从window经过目标的祖先节点传播到事件目标。 这个阶段被我们称之为捕获阶段。在这个阶段注册的事件监听器在事件到达其目标前必须先处理事件。\n    2、目标阶段：事件对象到达其事件目标。 这个阶段被我们称为目标阶段。一旦事件对象到达事件目标，该阶段的事件监听器就要对它进行处理。如果一个事件对象类型被标志为不能冒泡。那么对应的事件对象在到达此阶段时就会终止传播。\n    3、冒泡阶段：事件对象以一个与捕获阶段相反的方向从事件目标传播经过其祖先节点传播到window。这个阶段被称之为冒泡阶段。在此阶段注册的事件监听器会对相应的冒泡事件进行处理。\n## 跨浏览器EventUtil\n以下是js大神[Nicholas Zakas](https://github.com/nzakas/)写的[Professional JavaScript for Web Developers](https://www.amazon.cn/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1-%E6%B3%BD%E5%8D%A1%E6%96%AF/dp/B007OQQVMY)中的Cross Browser Event Utility\n查看[Hugh Dai Gist](https://gist.github.com/HughDai/a365e2515643e861ceff6b6181400449)\n```javascript\n    var EventUtil = {\n                addHandler: function( element, type, handler ) {\n                    if ( element.addEventListener ) {\n                        element.addEventListener ( type, handler, false );\n                    } else if ( element.attachEvent ) {\n                        element.attachEvent ( \"on\" + type, handler );\n                    } else {\n                        element[\"on\" + type] = handler;\n                    }\n                },\n                getEvent: function ( event ) {\n                    return event ? event : window.event;\n                },\n                getTarget: function ( event ) {\n                    return event.target || event.srcElement;\n                },\n                preventDefault: function ( event ) {\n                    if ( event.preventDefault ) {\n                        event.preventDefault();\n                    } else {\n                        event.returnValue = false;\n                    }\n                },\n                removeHandler: function( element, type, handler ) {\n                    if ( element.removeEventListener ) {\n                        element.removeEventListener ( type, handler, false );\n                    } else if ( element.detachEvent ) {\n                        element.detachEvent ( \"on\" + type, handler );\n                    } else {\n                        element[\"on\" + type] = null;\n                    }\n                },\n                stopPropagation: function ( event ) {\n                    if ( event.stopPropagation ) {\n                        event.stopPropagation();\n                    } else {\n                        event.cancelBubble = true;\n                    }\n                }\n            };\n```\n\n## Demo\n这里修改一下大神[Wilson Page](https://github.com/wilsonpage)的一个demo，更形象的描述事件流模型。\n\n<p data-height=\"600\" data-theme-id=\"0\" data-slug-hash=\"BzNjax\" data-default-tab=\"js,result\" data-user=\"HughDai\" data-embed-version=\"2\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/HughDai/pen/BzNjax/\">BzNjax</a> by Hugh Dai (<a href=\"http://codepen.io/HughDai\">@HughDai</a>) on <a href=\"http://codepen.io\">CodePen</a>.</p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>","slug":"事件模型","published":1,"updated":"2016-06-04T03:09:03.943Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cip0rl5mm00063ocgmg02ych1","content":"<h2 id=\"事件触发过程\"><a href=\"#事件触发过程\" class=\"headerlink\" title=\"事件触发过程\"></a>事件触发过程</h2><p>在前端开发中，经常会遇到事件监听，很多人对事件捕获及事件冒泡不置可否，以下是我对事件模型的一些看法，简单来说就是从外向内捕捉，然后到目标阶段后依次向上冒泡，详情请自行<a href=\"https://www.w3.org/TR/DOM-Level-3-Events/#event-flow\" target=\"_blank\" rel=\"external\">W3C</a>。<br>图片引用自<a href=\"https://www.w3.org/TR/DOM-Level-3-Events/#event-flow\" target=\"_blank\" rel=\"external\">W3C</a><br><img src=\"/img/eventflow.png\" alt=\"\"><br>    1、捕获阶段：在事件对象到达事件目标之前，事件对象必须从window经过目标的祖先节点传播到事件目标。 这个阶段被我们称之为捕获阶段。在这个阶段注册的事件监听器在事件到达其目标前必须先处理事件。<br>    2、目标阶段：事件对象到达其事件目标。 这个阶段被我们称为目标阶段。一旦事件对象到达事件目标，该阶段的事件监听器就要对它进行处理。如果一个事件对象类型被标志为不能冒泡。那么对应的事件对象在到达此阶段时就会终止传播。<br>    3、冒泡阶段：事件对象以一个与捕获阶段相反的方向从事件目标传播经过其祖先节点传播到window。这个阶段被称之为冒泡阶段。在此阶段注册的事件监听器会对相应的冒泡事件进行处理。</p>\n<h2 id=\"跨浏览器EventUtil\"><a href=\"#跨浏览器EventUtil\" class=\"headerlink\" title=\"跨浏览器EventUtil\"></a>跨浏览器EventUtil</h2><p>以下是js大神<a href=\"https://github.com/nzakas/\" target=\"_blank\" rel=\"external\">Nicholas Zakas</a>写的<a href=\"https://www.amazon.cn/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1-%E6%B3%BD%E5%8D%A1%E6%96%AF/dp/B007OQQVMY\" target=\"_blank\" rel=\"external\">Professional JavaScript for Web Developers</a>中的Cross Browser Event Utility<br>查看<a href=\"https://gist.github.com/HughDai/a365e2515643e861ceff6b6181400449\" target=\"_blank\" rel=\"external\">Hugh Dai Gist</a><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> EventUtil = &#123;</span><br><span class=\"line\">            addHandler: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"> element, type, handler </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( element.addEventListener ) &#123;</span><br><span class=\"line\">                    element.addEventListener ( type, handler, <span class=\"literal\">false</span> );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( element.attachEvent ) &#123;</span><br><span class=\"line\">                    element.attachEvent ( <span class=\"string\">\"on\"</span> + type, handler );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    element[<span class=\"string\">\"on\"</span> + type] = handler;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            getEvent: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> event ? event : <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            getTarget: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> event.target || event.srcElement;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            preventDefault: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( event.preventDefault ) &#123;</span><br><span class=\"line\">                    event.preventDefault();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    event.returnValue = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            removeHandler: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"> element, type, handler </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( element.removeEventListener ) &#123;</span><br><span class=\"line\">                    element.removeEventListener ( type, handler, <span class=\"literal\">false</span> );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( element.detachEvent ) &#123;</span><br><span class=\"line\">                    element.detachEvent ( <span class=\"string\">\"on\"</span> + type, handler );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    element[<span class=\"string\">\"on\"</span> + type] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            stopPropagation: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( event.stopPropagation ) &#123;</span><br><span class=\"line\">                    event.stopPropagation();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    event.cancelBubble = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>这里修改一下大神<a href=\"https://github.com/wilsonpage\" target=\"_blank\" rel=\"external\">Wilson Page</a>的一个demo，更形象的描述事件流模型。</p>\n<p></p><p data-height=\"600\" data-theme-id=\"0\" data-slug-hash=\"BzNjax\" data-default-tab=\"js,result\" data-user=\"HughDai\" data-embed-version=\"2\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/HughDai/pen/BzNjax/\" target=\"_blank\" rel=\"external\">BzNjax</a> by Hugh Dai (<a href=\"http://codepen.io/HughDai\" target=\"_blank\" rel=\"external\">@HughDai</a>) on <a href=\"http://codepen.io\" target=\"_blank\" rel=\"external\">CodePen</a>.</p><p></p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>","excerpt":"","more":"<h2 id=\"事件触发过程\"><a href=\"#事件触发过程\" class=\"headerlink\" title=\"事件触发过程\"></a>事件触发过程</h2><p>在前端开发中，经常会遇到事件监听，很多人对事件捕获及事件冒泡不置可否，以下是我对事件模型的一些看法，简单来说就是从外向内捕捉，然后到目标阶段后依次向上冒泡，详情请自行<a href=\"https://www.w3.org/TR/DOM-Level-3-Events/#event-flow\">W3C</a>。<br>图片引用自<a href=\"https://www.w3.org/TR/DOM-Level-3-Events/#event-flow\">W3C</a><br><img src=\"/img/eventflow.png\" alt=\"\"><br>    1、捕获阶段：在事件对象到达事件目标之前，事件对象必须从window经过目标的祖先节点传播到事件目标。 这个阶段被我们称之为捕获阶段。在这个阶段注册的事件监听器在事件到达其目标前必须先处理事件。<br>    2、目标阶段：事件对象到达其事件目标。 这个阶段被我们称为目标阶段。一旦事件对象到达事件目标，该阶段的事件监听器就要对它进行处理。如果一个事件对象类型被标志为不能冒泡。那么对应的事件对象在到达此阶段时就会终止传播。<br>    3、冒泡阶段：事件对象以一个与捕获阶段相反的方向从事件目标传播经过其祖先节点传播到window。这个阶段被称之为冒泡阶段。在此阶段注册的事件监听器会对相应的冒泡事件进行处理。</p>\n<h2 id=\"跨浏览器EventUtil\"><a href=\"#跨浏览器EventUtil\" class=\"headerlink\" title=\"跨浏览器EventUtil\"></a>跨浏览器EventUtil</h2><p>以下是js大神<a href=\"https://github.com/nzakas/\">Nicholas Zakas</a>写的<a href=\"https://www.amazon.cn/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1-%E6%B3%BD%E5%8D%A1%E6%96%AF/dp/B007OQQVMY\">Professional JavaScript for Web Developers</a>中的Cross Browser Event Utility<br>查看<a href=\"https://gist.github.com/HughDai/a365e2515643e861ceff6b6181400449\">Hugh Dai Gist</a><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> EventUtil = &#123;</span><br><span class=\"line\">            addHandler: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"> element, type, handler </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( element.addEventListener ) &#123;</span><br><span class=\"line\">                    element.addEventListener ( type, handler, <span class=\"literal\">false</span> );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( element.attachEvent ) &#123;</span><br><span class=\"line\">                    element.attachEvent ( <span class=\"string\">\"on\"</span> + type, handler );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    element[<span class=\"string\">\"on\"</span> + type] = handler;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            getEvent: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> event ? event : <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            getTarget: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> event.target || event.srcElement;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            preventDefault: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( event.preventDefault ) &#123;</span><br><span class=\"line\">                    event.preventDefault();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    event.returnValue = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            removeHandler: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"> element, type, handler </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( element.removeEventListener ) &#123;</span><br><span class=\"line\">                    element.removeEventListener ( type, handler, <span class=\"literal\">false</span> );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( element.detachEvent ) &#123;</span><br><span class=\"line\">                    element.detachEvent ( <span class=\"string\">\"on\"</span> + type, handler );</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    element[<span class=\"string\">\"on\"</span> + type] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            stopPropagation: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"> event </span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ( event.stopPropagation ) &#123;</span><br><span class=\"line\">                    event.stopPropagation();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    event.cancelBubble = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>这里修改一下大神<a href=\"https://github.com/wilsonpage\">Wilson Page</a>的一个demo，更形象的描述事件流模型。</p>\n<p><p data-height=\"600\" data-theme-id=\"0\" data-slug-hash=\"BzNjax\" data-default-tab=\"js,result\" data-user=\"HughDai\" data-embed-version=\"2\" class=\"codepen\">See the Pen <a href=\"http://codepen.io/HughDai/pen/BzNjax/\">BzNjax</a> by Hugh Dai (<a href=\"http://codepen.io/HughDai\">@HughDai</a>) on <a href=\"http://codepen.io\">CodePen</a>.</p></p>\n<script async src=\"//assets.codepen.io/assets/embed/ei.js\"></script>"},{"title":"理解javascript中的this","date":"2016-04-04T02:12:38.000Z","_content":"&emsp;&emsp;在js函数中，除了定义函数时的形参，还有两个附加参数，即this和arguments，本篇就讲一下this关键字的用法以及this在不同场景下值。\n初学时受启发得知this的指向取决于函数的调用方式，总结下来有以下几点：\n1、作为函数调用的模式，this指向window\n```javascript\nfunction func(){\n    console.log(this);\n}\n\nfunc();             //window\n```\n2、作为对象的方法调用的时候,this指向方法所在的对象\n```javascript\nvar obj = {};\nobj.name = 'hugh dai';\nobj.getNmae = function(){\n    console.log(this.name);\n}\n\nobj.getName();      //hugh dai\n```\n3、构造函数模式，this指向构造函数的实例\n```javascript\nfunction Person(name){\n    this.name = name;\n    this.getName = function(){\n        console.log(this.name);\n    }\n}\n\nvar p = new Person('hugh dai');\np.getName();        //hugh dai\n```\n4、bind/call/apply方式调用，this指向方法中的第一个参数\n```javascript\nvar foo = {\n    x: 3\n}\nvar bar = function(){\n    console.log(this.x);\n}\nbar(); // undefined\nbar.bind(foo)();    //3\nbar.call(foo);      //3\nbar.apply(foo);     //3\n```","source":"_posts/2016-04-04-理解javascript中的this.md","raw":"---\ntitle: 理解javascript中的this\ndate: 2016-04-04 10:12:38\ntags:\n---\n&emsp;&emsp;在js函数中，除了定义函数时的形参，还有两个附加参数，即this和arguments，本篇就讲一下this关键字的用法以及this在不同场景下值。\n初学时受启发得知this的指向取决于函数的调用方式，总结下来有以下几点：\n1、作为函数调用的模式，this指向window\n```javascript\nfunction func(){\n    console.log(this);\n}\n\nfunc();             //window\n```\n2、作为对象的方法调用的时候,this指向方法所在的对象\n```javascript\nvar obj = {};\nobj.name = 'hugh dai';\nobj.getNmae = function(){\n    console.log(this.name);\n}\n\nobj.getName();      //hugh dai\n```\n3、构造函数模式，this指向构造函数的实例\n```javascript\nfunction Person(name){\n    this.name = name;\n    this.getName = function(){\n        console.log(this.name);\n    }\n}\n\nvar p = new Person('hugh dai');\np.getName();        //hugh dai\n```\n4、bind/call/apply方式调用，this指向方法中的第一个参数\n```javascript\nvar foo = {\n    x: 3\n}\nvar bar = function(){\n    console.log(this.x);\n}\nbar(); // undefined\nbar.bind(foo)();    //3\nbar.call(foo);      //3\nbar.apply(foo);     //3\n```","slug":"理解javascript中的this","published":1,"updated":"2016-06-04T03:08:53.540Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cip0rl5mp00073ocgspd16763","content":"<p>&emsp;&emsp;在js函数中，除了定义函数时的形参，还有两个附加参数，即this和arguments，本篇就讲一下this关键字的用法以及this在不同场景下值。<br>初学时受启发得知this的指向取决于函数的调用方式，总结下来有以下几点：<br>1、作为函数调用的模式，this指向window<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">func</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">func();             <span class=\"comment\">//window</span></span><br></pre></td></tr></table></figure></p>\n<p>2、作为对象的方法调用的时候,this指向方法所在的对象<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> obj = &#123;&#125;;</span><br><span class=\"line\">obj.name = <span class=\"string\">'hugh dai'</span>;</span><br><span class=\"line\">obj.getNmae = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">obj.getName();      <span class=\"comment\">//hugh dai</span></span><br></pre></td></tr></table></figure></p>\n<p>3、构造函数模式，this指向构造函数的实例<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Person</span>(<span class=\"params\">name</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getName = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> Person(<span class=\"string\">'hugh dai'</span>);</span><br><span class=\"line\">p.getName();        <span class=\"comment\">//hugh dai</span></span><br></pre></td></tr></table></figure></p>\n<p>4、bind/call/apply方式调用，this指向方法中的第一个参数<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> foo = &#123;</span><br><span class=\"line\">    x: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> bar = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.x);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">bar(); <span class=\"comment\">// undefined</span></span><br><span class=\"line\">bar.bind(foo)();    <span class=\"comment\">//3</span></span><br><span class=\"line\">bar.call(foo);      <span class=\"comment\">//3</span></span><br><span class=\"line\">bar.apply(foo);     <span class=\"comment\">//3</span></span><br></pre></td></tr></table></figure></p>\n","excerpt":"","more":"<p>&emsp;&emsp;在js函数中，除了定义函数时的形参，还有两个附加参数，即this和arguments，本篇就讲一下this关键字的用法以及this在不同场景下值。<br>初学时受启发得知this的指向取决于函数的调用方式，总结下来有以下几点：<br>1、作为函数调用的模式，this指向window<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">func</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">func();             <span class=\"comment\">//window</span></span><br></pre></td></tr></table></figure></p>\n<p>2、作为对象的方法调用的时候,this指向方法所在的对象<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> obj = &#123;&#125;;</span><br><span class=\"line\">obj.name = <span class=\"string\">'hugh dai'</span>;</span><br><span class=\"line\">obj.getNmae = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">obj.getName();      <span class=\"comment\">//hugh dai</span></span><br></pre></td></tr></table></figure></p>\n<p>3、构造函数模式，this指向构造函数的实例<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Person</span>(<span class=\"params\">name</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getName = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> Person(<span class=\"string\">'hugh dai'</span>);</span><br><span class=\"line\">p.getName();        <span class=\"comment\">//hugh dai</span></span><br></pre></td></tr></table></figure></p>\n<p>4、bind/call/apply方式调用，this指向方法中的第一个参数<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> foo = &#123;</span><br><span class=\"line\">    x: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> bar = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.x);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">bar(); <span class=\"comment\">// undefined</span></span><br><span class=\"line\">bar.bind(foo)();    <span class=\"comment\">//3</span></span><br><span class=\"line\">bar.call(foo);      <span class=\"comment\">//3</span></span><br><span class=\"line\">bar.apply(foo);     <span class=\"comment\">//3</span></span><br></pre></td></tr></table></figure></p>\n"},{"title":"函数柯里化","date":"2016-04-21T14:57:42.000Z","_content":"转自[jcouyang的gits](https://gist.github.com/jcouyang/b56a830cd55bd230049f)\n\n还记得 Haskell Curry吗，![](http://s3.amazonaws.com/lyah/curry.png)\n\n多巧啊, 人家姓 Curry 名 Haskell, 难怪 Haskell 语言会自动柯里化, 呵呵. 但是不奇怪吗, 为什么要柯里化呢. 为什么如此重要导致 Haskell 会默认自动柯里化所有函数, 不就是返回一个部分配置好的函数吗.\n\n我们来看一个 Haskell 的代码.\n```haskell\nmax 3 4\n(max 3) 4\n```\n结果都是4, 这有设么用呢.\n\n这里看不出来, 放到`高阶函数`试试. 什么? 看不懂天书 Haskell, 来看看 JavaScript 吧.\n\n### 我们来解一个问题\n\n#### 1. 写一个函数, 可以连接字符数组, 如 `f(['1','2']) => '12'`\n\n好吧,如果不用柯里化, 怎么写? 啊哈 `reduce`\n\n```javascript\nvar concatArray = function(chars){\n  return chars.reduce(function(a, b){\n  \treturn a.concat(b);\n  });\n}\nconcat(['1','2','3']) // => '123'\n```\n很简单,对吧.\n\n#### 2. 现在我要其中所有数字加1, 然后在连接\n```javascript\nvar concatArray = function(chars, inc){\n  return chars.map(function(char){\n  \treturn (+char)+inc + '';\n  }).reduce(function(a,b){\n      return a.concat(b)\n  });\n}\nconsole.log(concatArray(['1','2','3'], 1))// => '234'\n```\n#### 3. 所有数字乘以2, 再重构试试看\n\n```javascript\nvar multiple = function(a, b){\n  return +a*b + ''\n}\nvar concatArray = function(chars, inc){\n  return chars.map(function(char){\n  \treturn multiple(char, inc);\n  }).reduce(function(a,b){\n      return a.concat(b)\n  });\n}\nconsole.log(concatArray(['1','2','3'], 2)) // => '246'\n```\n\n是不是已经看出问题了呢? 如果我在需要每个数字都减2,是不是很麻烦呢.需要将`map` 参数匿名函数中的 multiple 函数换掉. 这样一来`concatArray`就不能同时处理加, 乘和减? 那么怎么能把他提取出来呢? 来对比下柯里化的解法.\n\n### 柯里化函数接口\n```javascript\nvar multiple = function(a){\n  return function(b){\n    return +b*a + ''\n  }\n}\n\nvar plus = function(a){\n  return function(b){\n    return (+b)+a + ''\n  }\n}\nvar concatArray = function(chars, stylishChar){\n  return chars.map(stylishChar)\n    .reduce(function(a,b){\n      return a.concat(b)\n  });\n}\nconsole.log(concatArray(['1','2','3'], multiple(2)))\nconsole.log(concatArray(['1','2','3'], plus(2)))\n```\n有什么不一样呢\n1. 处理数组中字符的函数被提取出来, 作为参数传入\n2. 提取成柯里化的函数, 部分配置好后传入, 好处显而易见, 这下接口非常通畅\n无论是外层调用\n```\nconcatArray(['1','2','3'], multiple(2))\n```\n还是内部的 map 函数\n```\nchars.map(stylishChar)\n```\n这些接口都清晰了很多, 不是吗\n\n这就是函数式的思想, 用已有的函数组合出新的函数, 而柯里化每消费一个参数, 都会返回一个新的部分配置的函数, 这为函数组合提供了更灵活的手段, 并且使得接口更为流畅.\n\n再加上自动柯里化的库 [ramda](https://github.com/CrossEye/ramda), 简直就完美了\n```\nvar multiple = ramda.curry(function(a, b){\n  return +b*a + ''\n})\nvar plus = ramda.curry(function(a, b){\n  return (+b)+a + ''\n})\n```\n\n<a class=\"jsbin-embed\" href=\"http://jsbin.com/hamoq/3/embed\">JS Bin</a><script src=\"http://static.jsbin.com/js/embed.js\"></script>\n","source":"_posts/2016-04-21-函数柯里化(转).md","raw":"---\ntitle: 函数柯里化\ndate: 2016-04-21 22:57:42\ntags:\n---\n转自[jcouyang的gits](https://gist.github.com/jcouyang/b56a830cd55bd230049f)\n\n还记得 Haskell Curry吗，![](http://s3.amazonaws.com/lyah/curry.png)\n\n多巧啊, 人家姓 Curry 名 Haskell, 难怪 Haskell 语言会自动柯里化, 呵呵. 但是不奇怪吗, 为什么要柯里化呢. 为什么如此重要导致 Haskell 会默认自动柯里化所有函数, 不就是返回一个部分配置好的函数吗.\n\n我们来看一个 Haskell 的代码.\n```haskell\nmax 3 4\n(max 3) 4\n```\n结果都是4, 这有设么用呢.\n\n这里看不出来, 放到`高阶函数`试试. 什么? 看不懂天书 Haskell, 来看看 JavaScript 吧.\n\n### 我们来解一个问题\n\n#### 1. 写一个函数, 可以连接字符数组, 如 `f(['1','2']) => '12'`\n\n好吧,如果不用柯里化, 怎么写? 啊哈 `reduce`\n\n```javascript\nvar concatArray = function(chars){\n  return chars.reduce(function(a, b){\n  \treturn a.concat(b);\n  });\n}\nconcat(['1','2','3']) // => '123'\n```\n很简单,对吧.\n\n#### 2. 现在我要其中所有数字加1, 然后在连接\n```javascript\nvar concatArray = function(chars, inc){\n  return chars.map(function(char){\n  \treturn (+char)+inc + '';\n  }).reduce(function(a,b){\n      return a.concat(b)\n  });\n}\nconsole.log(concatArray(['1','2','3'], 1))// => '234'\n```\n#### 3. 所有数字乘以2, 再重构试试看\n\n```javascript\nvar multiple = function(a, b){\n  return +a*b + ''\n}\nvar concatArray = function(chars, inc){\n  return chars.map(function(char){\n  \treturn multiple(char, inc);\n  }).reduce(function(a,b){\n      return a.concat(b)\n  });\n}\nconsole.log(concatArray(['1','2','3'], 2)) // => '246'\n```\n\n是不是已经看出问题了呢? 如果我在需要每个数字都减2,是不是很麻烦呢.需要将`map` 参数匿名函数中的 multiple 函数换掉. 这样一来`concatArray`就不能同时处理加, 乘和减? 那么怎么能把他提取出来呢? 来对比下柯里化的解法.\n\n### 柯里化函数接口\n```javascript\nvar multiple = function(a){\n  return function(b){\n    return +b*a + ''\n  }\n}\n\nvar plus = function(a){\n  return function(b){\n    return (+b)+a + ''\n  }\n}\nvar concatArray = function(chars, stylishChar){\n  return chars.map(stylishChar)\n    .reduce(function(a,b){\n      return a.concat(b)\n  });\n}\nconsole.log(concatArray(['1','2','3'], multiple(2)))\nconsole.log(concatArray(['1','2','3'], plus(2)))\n```\n有什么不一样呢\n1. 处理数组中字符的函数被提取出来, 作为参数传入\n2. 提取成柯里化的函数, 部分配置好后传入, 好处显而易见, 这下接口非常通畅\n无论是外层调用\n```\nconcatArray(['1','2','3'], multiple(2))\n```\n还是内部的 map 函数\n```\nchars.map(stylishChar)\n```\n这些接口都清晰了很多, 不是吗\n\n这就是函数式的思想, 用已有的函数组合出新的函数, 而柯里化每消费一个参数, 都会返回一个新的部分配置的函数, 这为函数组合提供了更灵活的手段, 并且使得接口更为流畅.\n\n再加上自动柯里化的库 [ramda](https://github.com/CrossEye/ramda), 简直就完美了\n```\nvar multiple = ramda.curry(function(a, b){\n  return +b*a + ''\n})\nvar plus = ramda.curry(function(a, b){\n  return (+b)+a + ''\n})\n```\n\n<a class=\"jsbin-embed\" href=\"http://jsbin.com/hamoq/3/embed\">JS Bin</a><script src=\"http://static.jsbin.com/js/embed.js\"></script>\n","slug":"函数柯里化(转)","published":1,"updated":"2016-06-04T03:06:56.394Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cip0rl5mr00083ocgwid0yktp","content":"<p>转自<a href=\"https://gist.github.com/jcouyang/b56a830cd55bd230049f\" target=\"_blank\" rel=\"external\">jcouyang的gits</a></p>\n<p>还记得 Haskell Curry吗，<img src=\"http://s3.amazonaws.com/lyah/curry.png\" alt=\"\"></p>\n<p>多巧啊, 人家姓 Curry 名 Haskell, 难怪 Haskell 语言会自动柯里化, 呵呵. 但是不奇怪吗, 为什么要柯里化呢. 为什么如此重要导致 Haskell 会默认自动柯里化所有函数, 不就是返回一个部分配置好的函数吗.</p>\n<p>我们来看一个 Haskell 的代码.<br><figure class=\"highlight haskell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title\">max</span> <span class=\"number\">3</span> <span class=\"number\">4</span></span><br><span class=\"line\">(max <span class=\"number\">3</span>) <span class=\"number\">4</span></span><br></pre></td></tr></table></figure></p>\n<p>结果都是4, 这有设么用呢.</p>\n<p>这里看不出来, 放到<code>高阶函数</code>试试. 什么? 看不懂天书 Haskell, 来看看 JavaScript 吧.</p>\n<h3 id=\"我们来解一个问题\"><a href=\"#我们来解一个问题\" class=\"headerlink\" title=\"我们来解一个问题\"></a>我们来解一个问题</h3><h4 id=\"1-写一个函数-可以连接字符数组-如-f-39-1-39-39-2-39-gt-39-12-39\"><a href=\"#1-写一个函数-可以连接字符数组-如-f-39-1-39-39-2-39-gt-39-12-39\" class=\"headerlink\" title=\"1. 写一个函数, 可以连接字符数组, 如 f([&#39;1&#39;,&#39;2&#39;]) =&gt; &#39;12&#39;\"></a>1. 写一个函数, 可以连接字符数组, 如 <code>f([&#39;1&#39;,&#39;2&#39;]) =&gt; &#39;12&#39;</code></h4><p>好吧,如果不用柯里化, 怎么写? 啊哈 <code>reduce</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a, b</span>)</span>&#123;</span><br><span class=\"line\">  \t<span class=\"keyword\">return</span> a.concat(b);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">concat([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>]) <span class=\"comment\">// =&gt; '123'</span></span><br></pre></td></tr></table></figure>\n<p>很简单,对吧.</p>\n<h4 id=\"2-现在我要其中所有数字加1-然后在连接\"><a href=\"#2-现在我要其中所有数字加1-然后在连接\" class=\"headerlink\" title=\"2. 现在我要其中所有数字加1, 然后在连接\"></a>2. 现在我要其中所有数字加1, 然后在连接</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars, inc</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">char</span>)</span>&#123;</span><br><span class=\"line\">  \t<span class=\"keyword\">return</span> (+char)+inc + <span class=\"string\">''</span>;</span><br><span class=\"line\">  &#125;).reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a,b</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> a.concat(b)</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], <span class=\"number\">1</span>))<span class=\"comment\">// =&gt; '234'</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"3-所有数字乘以2-再重构试试看\"><a href=\"#3-所有数字乘以2-再重构试试看\" class=\"headerlink\" title=\"3. 所有数字乘以2, 再重构试试看\"></a>3. 所有数字乘以2, 再重构试试看</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> multiple = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a, b</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> +a*b + <span class=\"string\">''</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars, inc</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">char</span>)</span>&#123;</span><br><span class=\"line\">  \t<span class=\"keyword\">return</span> multiple(char, inc);</span><br><span class=\"line\">  &#125;).reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a,b</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> a.concat(b)</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], <span class=\"number\">2</span>)) <span class=\"comment\">// =&gt; '246'</span></span><br></pre></td></tr></table></figure>\n<p>是不是已经看出问题了呢? 如果我在需要每个数字都减2,是不是很麻烦呢.需要将<code>map</code> 参数匿名函数中的 multiple 函数换掉. 这样一来<code>concatArray</code>就不能同时处理加, 乘和减? 那么怎么能把他提取出来呢? 来对比下柯里化的解法.</p>\n<h3 id=\"柯里化函数接口\"><a href=\"#柯里化函数接口\" class=\"headerlink\" title=\"柯里化函数接口\"></a>柯里化函数接口</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> multiple = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">b</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> +b*a + <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> plus = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">b</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (+b)+a + <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars, stylishChar</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.map(stylishChar)</span><br><span class=\"line\">    .reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a,b</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> a.concat(b)</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], multiple(<span class=\"number\">2</span>)))</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], plus(<span class=\"number\">2</span>)))</span><br></pre></td></tr></table></figure>\n<p>有什么不一样呢</p>\n<ol>\n<li>处理数组中字符的函数被提取出来, 作为参数传入</li>\n<li>提取成柯里化的函数, 部分配置好后传入, 好处显而易见, 这下接口非常通畅<br>无论是外层调用<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">concatArray([&apos;1&apos;,&apos;2&apos;,&apos;3&apos;], multiple(2))</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>还是内部的 map 函数<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chars.map(stylishChar)</span><br></pre></td></tr></table></figure></p>\n<p>这些接口都清晰了很多, 不是吗</p>\n<p>这就是函数式的思想, 用已有的函数组合出新的函数, 而柯里化每消费一个参数, 都会返回一个新的部分配置的函数, 这为函数组合提供了更灵活的手段, 并且使得接口更为流畅.</p>\n<p>再加上自动柯里化的库 <a href=\"https://github.com/CrossEye/ramda\" target=\"_blank\" rel=\"external\">ramda</a>, 简直就完美了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var multiple = ramda.curry(function(a, b)&#123;</span><br><span class=\"line\">  return +b*a + &apos;&apos;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">var plus = ramda.curry(function(a, b)&#123;</span><br><span class=\"line\">  return (+b)+a + &apos;&apos;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p><a class=\"jsbin-embed\" href=\"http://jsbin.com/hamoq/3/embed\" target=\"_blank\" rel=\"external\">JS Bin</a><script src=\"http://static.jsbin.com/js/embed.js\"></script></p>\n","excerpt":"","more":"<p>转自<a href=\"https://gist.github.com/jcouyang/b56a830cd55bd230049f\">jcouyang的gits</a></p>\n<p>还记得 Haskell Curry吗，<img src=\"http://s3.amazonaws.com/lyah/curry.png\" alt=\"\"></p>\n<p>多巧啊, 人家姓 Curry 名 Haskell, 难怪 Haskell 语言会自动柯里化, 呵呵. 但是不奇怪吗, 为什么要柯里化呢. 为什么如此重要导致 Haskell 会默认自动柯里化所有函数, 不就是返回一个部分配置好的函数吗.</p>\n<p>我们来看一个 Haskell 的代码.<br><figure class=\"highlight haskell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title\">max</span> <span class=\"number\">3</span> <span class=\"number\">4</span></span><br><span class=\"line\">(max <span class=\"number\">3</span>) <span class=\"number\">4</span></span><br></pre></td></tr></table></figure></p>\n<p>结果都是4, 这有设么用呢.</p>\n<p>这里看不出来, 放到<code>高阶函数</code>试试. 什么? 看不懂天书 Haskell, 来看看 JavaScript 吧.</p>\n<h3 id=\"我们来解一个问题\"><a href=\"#我们来解一个问题\" class=\"headerlink\" title=\"我们来解一个问题\"></a>我们来解一个问题</h3><h4 id=\"1-写一个函数-可以连接字符数组-如-f-39-1-39-39-2-39-gt-39-12-39\"><a href=\"#1-写一个函数-可以连接字符数组-如-f-39-1-39-39-2-39-gt-39-12-39\" class=\"headerlink\" title=\"1. 写一个函数, 可以连接字符数组, 如 f([&#39;1&#39;,&#39;2&#39;]) =&gt; &#39;12&#39;\"></a>1. 写一个函数, 可以连接字符数组, 如 <code>f([&#39;1&#39;,&#39;2&#39;]) =&gt; &#39;12&#39;</code></h4><p>好吧,如果不用柯里化, 怎么写? 啊哈 <code>reduce</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a, b</span>)</span>&#123;</span><br><span class=\"line\">  \t<span class=\"keyword\">return</span> a.concat(b);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">concat([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>]) <span class=\"comment\">// =&gt; '123'</span></span><br></pre></td></tr></table></figure>\n<p>很简单,对吧.</p>\n<h4 id=\"2-现在我要其中所有数字加1-然后在连接\"><a href=\"#2-现在我要其中所有数字加1-然后在连接\" class=\"headerlink\" title=\"2. 现在我要其中所有数字加1, 然后在连接\"></a>2. 现在我要其中所有数字加1, 然后在连接</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars, inc</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">char</span>)</span>&#123;</span><br><span class=\"line\">  \t<span class=\"keyword\">return</span> (+char)+inc + <span class=\"string\">''</span>;</span><br><span class=\"line\">  &#125;).reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a,b</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> a.concat(b)</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], <span class=\"number\">1</span>))<span class=\"comment\">// =&gt; '234'</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"3-所有数字乘以2-再重构试试看\"><a href=\"#3-所有数字乘以2-再重构试试看\" class=\"headerlink\" title=\"3. 所有数字乘以2, 再重构试试看\"></a>3. 所有数字乘以2, 再重构试试看</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> multiple = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a, b</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> +a*b + <span class=\"string\">''</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars, inc</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">char</span>)</span>&#123;</span><br><span class=\"line\">  \t<span class=\"keyword\">return</span> multiple(char, inc);</span><br><span class=\"line\">  &#125;).reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a,b</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> a.concat(b)</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], <span class=\"number\">2</span>)) <span class=\"comment\">// =&gt; '246'</span></span><br></pre></td></tr></table></figure>\n<p>是不是已经看出问题了呢? 如果我在需要每个数字都减2,是不是很麻烦呢.需要将<code>map</code> 参数匿名函数中的 multiple 函数换掉. 这样一来<code>concatArray</code>就不能同时处理加, 乘和减? 那么怎么能把他提取出来呢? 来对比下柯里化的解法.</p>\n<h3 id=\"柯里化函数接口\"><a href=\"#柯里化函数接口\" class=\"headerlink\" title=\"柯里化函数接口\"></a>柯里化函数接口</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> multiple = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">b</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> +b*a + <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> plus = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">b</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (+b)+a + <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> concatArray = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chars, stylishChar</span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> chars.map(stylishChar)</span><br><span class=\"line\">    .reduce(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">a,b</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> a.concat(b)</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], multiple(<span class=\"number\">2</span>)))</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(concatArray([<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>], plus(<span class=\"number\">2</span>)))</span><br></pre></td></tr></table></figure>\n<p>有什么不一样呢</p>\n<ol>\n<li>处理数组中字符的函数被提取出来, 作为参数传入</li>\n<li>提取成柯里化的函数, 部分配置好后传入, 好处显而易见, 这下接口非常通畅<br>无论是外层调用<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">concatArray([&apos;1&apos;,&apos;2&apos;,&apos;3&apos;], multiple(2))</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>还是内部的 map 函数<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chars.map(stylishChar)</span><br></pre></td></tr></table></figure></p>\n<p>这些接口都清晰了很多, 不是吗</p>\n<p>这就是函数式的思想, 用已有的函数组合出新的函数, 而柯里化每消费一个参数, 都会返回一个新的部分配置的函数, 这为函数组合提供了更灵活的手段, 并且使得接口更为流畅.</p>\n<p>再加上自动柯里化的库 <a href=\"https://github.com/CrossEye/ramda\">ramda</a>, 简直就完美了<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var multiple = ramda.curry(function(a, b)&#123;</span><br><span class=\"line\">  return +b*a + &apos;&apos;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">var plus = ramda.curry(function(a, b)&#123;</span><br><span class=\"line\">  return (+b)+a + &apos;&apos;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p><a class=\"jsbin-embed\" href=\"http://jsbin.com/hamoq/3/embed\">JS Bin</a><script src=\"http://static.jsbin.com/js/embed.js\"></script></p>\n"},{"title":"原生ajax","date":"2016-04-21T14:55:15.000Z","_content":"原生js实现ajax包括get和post\n\n```javascript\nfunction Ajax(type, url, data, success, failed) {\n            // 创建ajax对象\n            var xhr = null;\n            if (window.XMLHttpRequest) {\n                xhr = new XMLHttpRequest();\n            } else {\n                xhr = new ActiveXObject('Microsoft.XMLHTTP')\n            }\n\n            var type = type.toUpperCase();\n            // 用于清除缓存\n            var random = Math.random();\n\n            if (typeof data == 'object') {\n                var str = '';\n                for (var key in data) {\n                    str += key + '=' + data[key] + '&';\n                }\n                data = str.replace(/&$/, '');\n            }\n\n            if (type == 'GET') {\n                if (data) {\n                    xhr.open('GET', url + '?' + data, true);\n                } else {\n                    xhr.open('GET', url + '?t=' + random, true);\n                }\n                xhr.send();\n\n            } else if (type == 'POST') {\n                xhr.open('POST', url, true);\n                // 如果需要像 html 表单那样 POST 数据，请使用 setRequestHeader() 来添加 http 头。\n                xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n                xhr.send(data);\n            }\n\n            // 处理返回数据\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState == 4) {\n                    if (xhr.status == 200) {\n                        success(xhr.responseText);\n                    } else {\n                        if (failed) {\n                            failed(xhr.status);\n                        }\n                    }\n                }\n            }\n        }\n```","source":"_posts/2016-04-21-原生ajax.md","raw":"---\ntitle: 原生ajax\ndate: 2016-04-21 22:55:15\ntags:\n---\n原生js实现ajax包括get和post\n\n```javascript\nfunction Ajax(type, url, data, success, failed) {\n            // 创建ajax对象\n            var xhr = null;\n            if (window.XMLHttpRequest) {\n                xhr = new XMLHttpRequest();\n            } else {\n                xhr = new ActiveXObject('Microsoft.XMLHTTP')\n            }\n\n            var type = type.toUpperCase();\n            // 用于清除缓存\n            var random = Math.random();\n\n            if (typeof data == 'object') {\n                var str = '';\n                for (var key in data) {\n                    str += key + '=' + data[key] + '&';\n                }\n                data = str.replace(/&$/, '');\n            }\n\n            if (type == 'GET') {\n                if (data) {\n                    xhr.open('GET', url + '?' + data, true);\n                } else {\n                    xhr.open('GET', url + '?t=' + random, true);\n                }\n                xhr.send();\n\n            } else if (type == 'POST') {\n                xhr.open('POST', url, true);\n                // 如果需要像 html 表单那样 POST 数据，请使用 setRequestHeader() 来添加 http 头。\n                xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n                xhr.send(data);\n            }\n\n            // 处理返回数据\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState == 4) {\n                    if (xhr.status == 200) {\n                        success(xhr.responseText);\n                    } else {\n                        if (failed) {\n                            failed(xhr.status);\n                        }\n                    }\n                }\n            }\n        }\n```","slug":"原生ajax","published":1,"updated":"2016-06-04T03:08:31.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cip0rl5mv00093ocg8xtk85eh","content":"<p>原生js实现ajax包括get和post</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Ajax</span>(<span class=\"params\">type, url, data, success, failed</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 创建ajax对象</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> xhr = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.XMLHttpRequest) &#123;</span><br><span class=\"line\">                xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'Microsoft.XMLHTTP'</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">var</span> type = type.toUpperCase();</span><br><span class=\"line\">            <span class=\"comment\">// 用于清除缓存</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> random = <span class=\"built_in\">Math</span>.random();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> data == <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> str = <span class=\"string\">''</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> data) &#123;</span><br><span class=\"line\">                    str += key + <span class=\"string\">'='</span> + data[key] + <span class=\"string\">'&amp;'</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                data = str.replace(<span class=\"regexp\">/&amp;$/</span>, <span class=\"string\">''</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (type == <span class=\"string\">'GET'</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (data) &#123;</span><br><span class=\"line\">                    xhr.open(<span class=\"string\">'GET'</span>, url + <span class=\"string\">'?'</span> + data, <span class=\"literal\">true</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    xhr.open(<span class=\"string\">'GET'</span>, url + <span class=\"string\">'?t='</span> + random, <span class=\"literal\">true</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                xhr.send();</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (type == <span class=\"string\">'POST'</span>) &#123;</span><br><span class=\"line\">                xhr.open(<span class=\"string\">'POST'</span>, url, <span class=\"literal\">true</span>);</span><br><span class=\"line\">                <span class=\"comment\">// 如果需要像 html 表单那样 POST 数据，请使用 setRequestHeader() 来添加 http 头。</span></span><br><span class=\"line\">                xhr.setRequestHeader(<span class=\"string\">\"Content-type\"</span>, <span class=\"string\">\"application/x-www-form-urlencoded\"</span>);</span><br><span class=\"line\">                xhr.send(data);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 处理返回数据</span></span><br><span class=\"line\">            xhr.onreadystatechange = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (xhr.readyState == <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (xhr.status == <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">                        success(xhr.responseText);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (failed) &#123;</span><br><span class=\"line\">                            failed(xhr.status);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>","excerpt":"","more":"<p>原生js实现ajax包括get和post</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Ajax</span>(<span class=\"params\">type, url, data, success, failed</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 创建ajax对象</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> xhr = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.XMLHttpRequest) &#123;</span><br><span class=\"line\">                xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                xhr = <span class=\"keyword\">new</span> ActiveXObject(<span class=\"string\">'Microsoft.XMLHTTP'</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">var</span> type = type.toUpperCase();</span><br><span class=\"line\">            <span class=\"comment\">// 用于清除缓存</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> random = <span class=\"built_in\">Math</span>.random();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> data == <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> str = <span class=\"string\">''</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> data) &#123;</span><br><span class=\"line\">                    str += key + <span class=\"string\">'='</span> + data[key] + <span class=\"string\">'&amp;'</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                data = str.replace(<span class=\"regexp\">/&amp;$/</span>, <span class=\"string\">''</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (type == <span class=\"string\">'GET'</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (data) &#123;</span><br><span class=\"line\">                    xhr.open(<span class=\"string\">'GET'</span>, url + <span class=\"string\">'?'</span> + data, <span class=\"literal\">true</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    xhr.open(<span class=\"string\">'GET'</span>, url + <span class=\"string\">'?t='</span> + random, <span class=\"literal\">true</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                xhr.send();</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (type == <span class=\"string\">'POST'</span>) &#123;</span><br><span class=\"line\">                xhr.open(<span class=\"string\">'POST'</span>, url, <span class=\"literal\">true</span>);</span><br><span class=\"line\">                <span class=\"comment\">// 如果需要像 html 表单那样 POST 数据，请使用 setRequestHeader() 来添加 http 头。</span></span><br><span class=\"line\">                xhr.setRequestHeader(<span class=\"string\">\"Content-type\"</span>, <span class=\"string\">\"application/x-www-form-urlencoded\"</span>);</span><br><span class=\"line\">                xhr.send(data);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 处理返回数据</span></span><br><span class=\"line\">            xhr.onreadystatechange = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (xhr.readyState == <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (xhr.status == <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">                        success(xhr.responseText);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (failed) &#123;</span><br><span class=\"line\">                            failed(xhr.status);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>"},{"title":"js依赖注入","date":"2016-05-04T03:12:27.000Z","_content":"相信用过AngularJS框架的jser应该都知道依赖注入的概念。依赖注入(Dependency Injection)简称DI,做过后台的程序员应该都不会陌生,因为很多后端语言，诸如C#、JAVA都有很好的框架支持，如JAVA中的Spring和C#中的Autofac。\n关于控制反转(IOC)、依赖注入(DI)，博客园有一篇好文[依赖注入那些事儿](http://www.cnblogs.com/leoo2sk/archive/2009/06/17/1504693.html)。\n##  分析\n依赖注入本质用途就是解决项目中的硬编码，降低代码耦合度，有效的管理模块依赖。RequireJS和AngularJS都有依赖注入的解决方案,AngularJS有一个内在的依赖注入机制，使用AngularJS，你可以把你的App分成许多个可以重复使用的组件，当需要这些组件的时候，可以通过依赖注入把这些组件注入到你的App中去。\nRequireJS\n```javascript\ndefine(['module1','module2'], function(module1, module2) {\n    // ...\n});\n```\nAngularJS\n```javascript\nangular.module('gulpAngular',\n [\n    'ngAnimate',\n    'ngCookies',\n    'ngTouch'\n    ]);\n```\n使用依赖注入我们应该要达到以下目标\n1、我们应该能够注册依赖关系\n2、注入应该接受一个函数，并返回一个我们需要的函数\n3、我们不能写太多东西——我们需要精简漂亮的语法\n4、注入应该保持被传递函数的作用域\n5、被传递的函数应该能够接受自定义参数，而不仅仅是依赖描述\n6、堪称完美的清单，下面 让我们实现它。\n##  代码实现\n首先，定义一个对象叫做injector，\n```javascript\nvar injector = {\n  dependencies: {},\n  register: function(name, src) {\n    this.dependencies[name] = src;\n  },\n  resolve: function(target) {\n\n  }\n};\n````\ninjector对象中有两个方法，regist负责注册需要依赖的模块并存在dependencies中，第二个方法是resolve，这个方法接收的参数是我们我们要注入依赖的对象，这里的关键的点就是这个注入器不应该调用我们的函数，所以我们在resolve方法中返回一个闭包来包裹我们的target,然后再调用它：\n```javascript\nresolve: function(target) {\n  return function() {\n    target();\n  };\n}\n```\n下一步到AngularJS源码中找到annotate方法，此方法将目标函数转换为一个字符串，删除它的注释(如果有)，然后提取他的参数(依赖项)：\n```javascript\nvar FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\nvar STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\nfnText = target.toString().replace(STRIP_COMMENTS, '');\nargDecl = fnText.match(FN_ARGS)[1].split(/, ?/g);\nvar args = [];\nfor (var i = 0; i < argDecl.length; i++) {\n    if (this.dependencies[argDecl[i]]) {\n       args.push(this.dependencies[argDecl[i]]);\n     }\n}\nreturn function () {\n     target.apply({}, args);\n}\n```\n```javascript\nvar injector = {\n            //依赖库\n            dependencies: {},\n            //注册依赖\n            regist: function (name, src) {\n                this.dependencies[name] = src;\n            },\n            /**\n             * 返回闭包包裹要调用的函数\n             * @param target 需要注入的对象\n             * @returns {Function}\n             */\n            resolve: function (target) {\n                var FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\n                var STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\n                fnText = target.toString().replace(STRIP_COMMENTS, '');\n                argDecl = fnText.match(FN_ARGS)[1].split(/, ?/g);\n                var args = [];\n                for (var i = 0; i < argDecl.length; i++) {\n                    if (this.dependencies[argDecl[i]]) {\n                        args.push(this.dependencies[argDecl[i]]);\n                    }\n                }\n                return function () {\n                    target.apply({}, args);\n                }\n            }\n        };\n```\n","source":"_posts/2016-05-04-js依赖注入.md","raw":"---\ntitle: js依赖注入\ndate: 2016-05-04 11:12:27\ntags:\n---\n相信用过AngularJS框架的jser应该都知道依赖注入的概念。依赖注入(Dependency Injection)简称DI,做过后台的程序员应该都不会陌生,因为很多后端语言，诸如C#、JAVA都有很好的框架支持，如JAVA中的Spring和C#中的Autofac。\n关于控制反转(IOC)、依赖注入(DI)，博客园有一篇好文[依赖注入那些事儿](http://www.cnblogs.com/leoo2sk/archive/2009/06/17/1504693.html)。\n##  分析\n依赖注入本质用途就是解决项目中的硬编码，降低代码耦合度，有效的管理模块依赖。RequireJS和AngularJS都有依赖注入的解决方案,AngularJS有一个内在的依赖注入机制，使用AngularJS，你可以把你的App分成许多个可以重复使用的组件，当需要这些组件的时候，可以通过依赖注入把这些组件注入到你的App中去。\nRequireJS\n```javascript\ndefine(['module1','module2'], function(module1, module2) {\n    // ...\n});\n```\nAngularJS\n```javascript\nangular.module('gulpAngular',\n [\n    'ngAnimate',\n    'ngCookies',\n    'ngTouch'\n    ]);\n```\n使用依赖注入我们应该要达到以下目标\n1、我们应该能够注册依赖关系\n2、注入应该接受一个函数，并返回一个我们需要的函数\n3、我们不能写太多东西——我们需要精简漂亮的语法\n4、注入应该保持被传递函数的作用域\n5、被传递的函数应该能够接受自定义参数，而不仅仅是依赖描述\n6、堪称完美的清单，下面 让我们实现它。\n##  代码实现\n首先，定义一个对象叫做injector，\n```javascript\nvar injector = {\n  dependencies: {},\n  register: function(name, src) {\n    this.dependencies[name] = src;\n  },\n  resolve: function(target) {\n\n  }\n};\n````\ninjector对象中有两个方法，regist负责注册需要依赖的模块并存在dependencies中，第二个方法是resolve，这个方法接收的参数是我们我们要注入依赖的对象，这里的关键的点就是这个注入器不应该调用我们的函数，所以我们在resolve方法中返回一个闭包来包裹我们的target,然后再调用它：\n```javascript\nresolve: function(target) {\n  return function() {\n    target();\n  };\n}\n```\n下一步到AngularJS源码中找到annotate方法，此方法将目标函数转换为一个字符串，删除它的注释(如果有)，然后提取他的参数(依赖项)：\n```javascript\nvar FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\nvar STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\nfnText = target.toString().replace(STRIP_COMMENTS, '');\nargDecl = fnText.match(FN_ARGS)[1].split(/, ?/g);\nvar args = [];\nfor (var i = 0; i < argDecl.length; i++) {\n    if (this.dependencies[argDecl[i]]) {\n       args.push(this.dependencies[argDecl[i]]);\n     }\n}\nreturn function () {\n     target.apply({}, args);\n}\n```\n```javascript\nvar injector = {\n            //依赖库\n            dependencies: {},\n            //注册依赖\n            regist: function (name, src) {\n                this.dependencies[name] = src;\n            },\n            /**\n             * 返回闭包包裹要调用的函数\n             * @param target 需要注入的对象\n             * @returns {Function}\n             */\n            resolve: function (target) {\n                var FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\n                var STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\n                fnText = target.toString().replace(STRIP_COMMENTS, '');\n                argDecl = fnText.match(FN_ARGS)[1].split(/, ?/g);\n                var args = [];\n                for (var i = 0; i < argDecl.length; i++) {\n                    if (this.dependencies[argDecl[i]]) {\n                        args.push(this.dependencies[argDecl[i]]);\n                    }\n                }\n                return function () {\n                    target.apply({}, args);\n                }\n            }\n        };\n```\n","slug":"js依赖注入","published":1,"updated":"2016-06-04T06:03:18.006Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cip0rl5mz000a3ocgoson2lhk","content":"<p>相信用过AngularJS框架的jser应该都知道依赖注入的概念。依赖注入(Dependency Injection)简称DI,做过后台的程序员应该都不会陌生,因为很多后端语言，诸如C#、JAVA都有很好的框架支持，如JAVA中的Spring和C#中的Autofac。<br>关于控制反转(IOC)、依赖注入(DI)，博客园有一篇好文<a href=\"http://www.cnblogs.com/leoo2sk/archive/2009/06/17/1504693.html\" target=\"_blank\" rel=\"external\">依赖注入那些事儿</a>。</p>\n<h2 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h2><p>依赖注入本质用途就是解决项目中的硬编码，降低代码耦合度，有效的管理模块依赖。RequireJS和AngularJS都有依赖注入的解决方案,AngularJS有一个内在的依赖注入机制，使用AngularJS，你可以把你的App分成许多个可以重复使用的组件，当需要这些组件的时候，可以通过依赖注入把这些组件注入到你的App中去。<br>RequireJS<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">define([<span class=\"string\">'module1'</span>,<span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>AngularJS<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">angular.module(<span class=\"string\">'gulpAngular'</span>,</span><br><span class=\"line\"> [</span><br><span class=\"line\">    <span class=\"string\">'ngAnimate'</span>,</span><br><span class=\"line\">    <span class=\"string\">'ngCookies'</span>,</span><br><span class=\"line\">    <span class=\"string\">'ngTouch'</span></span><br><span class=\"line\">    ]);</span><br></pre></td></tr></table></figure></p>\n<p>使用依赖注入我们应该要达到以下目标<br>1、我们应该能够注册依赖关系<br>2、注入应该接受一个函数，并返回一个我们需要的函数<br>3、我们不能写太多东西——我们需要精简漂亮的语法<br>4、注入应该保持被传递函数的作用域<br>5、被传递的函数应该能够接受自定义参数，而不仅仅是依赖描述<br>6、堪称完美的清单，下面 让我们实现它。</p>\n<h2 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h2><p>首先，定义一个对象叫做injector，<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> injector = &#123;</span><br><span class=\"line\">  dependencies: &#123;&#125;,</span><br><span class=\"line\">  register: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, src</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.dependencies[name] = src;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  resolve: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">target</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"string\">`</span></span><br></pre></td></tr></table></figure></p>\n<p>injector对象中有两个方法，regist负责注册需要依赖的模块并存在dependencies中，第二个方法是resolve，这个方法接收的参数是我们我们要注入依赖的对象，这里的关键的点就是这个注入器不应该调用我们的函数，所以我们在resolve方法中返回一个闭包来包裹我们的target,然后再调用它：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">resolve: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">target</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    target();</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>下一步到AngularJS源码中找到annotate方法，此方法将目标函数转换为一个字符串，删除它的注释(如果有)，然后提取他的参数(依赖项)：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> FN_ARGS = <span class=\"regexp\">/^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> STRIP_COMMENTS = <span class=\"regexp\">/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg</span>;</span><br><span class=\"line\">fnText = target.toString().replace(STRIP_COMMENTS, <span class=\"string\">''</span>);</span><br><span class=\"line\">argDecl = fnText.match(FN_ARGS)[<span class=\"number\">1</span>].split(<span class=\"regexp\">/, ?/g</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> args = [];</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; argDecl.length; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.dependencies[argDecl[i]]) &#123;</span><br><span class=\"line\">       args.push(<span class=\"keyword\">this</span>.dependencies[argDecl[i]]);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">     target.apply(&#123;&#125;, args);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> injector = &#123;</span><br><span class=\"line\">            <span class=\"comment\">//依赖库</span></span><br><span class=\"line\">            dependencies: &#123;&#125;,</span><br><span class=\"line\">            <span class=\"comment\">//注册依赖</span></span><br><span class=\"line\">            regist: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, src</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.dependencies[name] = src;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"comment\">/**</span><br><span class=\"line\">             * 返回闭包包裹要调用的函数</span><br><span class=\"line\">             * @param target 需要注入的对象</span><br><span class=\"line\">             * @returns &#123;Function&#125;</span><br><span class=\"line\">             */</span></span><br><span class=\"line\">            resolve: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">target</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> FN_ARGS = <span class=\"regexp\">/^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m</span>;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> STRIP_COMMENTS = <span class=\"regexp\">/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg</span>;</span><br><span class=\"line\">                fnText = target.toString().replace(STRIP_COMMENTS, <span class=\"string\">''</span>);</span><br><span class=\"line\">                argDecl = fnText.match(FN_ARGS)[<span class=\"number\">1</span>].split(<span class=\"regexp\">/, ?/g</span>);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> args = [];</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; argDecl.length; i++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.dependencies[argDecl[i]]) &#123;</span><br><span class=\"line\">                        args.push(<span class=\"keyword\">this</span>.dependencies[argDecl[i]]);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                    target.apply(&#123;&#125;, args);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br></pre></td></tr></table></figure>\n","excerpt":"","more":"<p>相信用过AngularJS框架的jser应该都知道依赖注入的概念。依赖注入(Dependency Injection)简称DI,做过后台的程序员应该都不会陌生,因为很多后端语言，诸如C#、JAVA都有很好的框架支持，如JAVA中的Spring和C#中的Autofac。<br>关于控制反转(IOC)、依赖注入(DI)，博客园有一篇好文<a href=\"http://www.cnblogs.com/leoo2sk/archive/2009/06/17/1504693.html\">依赖注入那些事儿</a>。</p>\n<h2 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h2><p>依赖注入本质用途就是解决项目中的硬编码，降低代码耦合度，有效的管理模块依赖。RequireJS和AngularJS都有依赖注入的解决方案,AngularJS有一个内在的依赖注入机制，使用AngularJS，你可以把你的App分成许多个可以重复使用的组件，当需要这些组件的时候，可以通过依赖注入把这些组件注入到你的App中去。<br>RequireJS<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">define([<span class=\"string\">'module1'</span>,<span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>AngularJS<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">angular.module(<span class=\"string\">'gulpAngular'</span>,</span><br><span class=\"line\"> [</span><br><span class=\"line\">    <span class=\"string\">'ngAnimate'</span>,</span><br><span class=\"line\">    <span class=\"string\">'ngCookies'</span>,</span><br><span class=\"line\">    <span class=\"string\">'ngTouch'</span></span><br><span class=\"line\">    ]);</span><br></pre></td></tr></table></figure></p>\n<p>使用依赖注入我们应该要达到以下目标<br>1、我们应该能够注册依赖关系<br>2、注入应该接受一个函数，并返回一个我们需要的函数<br>3、我们不能写太多东西——我们需要精简漂亮的语法<br>4、注入应该保持被传递函数的作用域<br>5、被传递的函数应该能够接受自定义参数，而不仅仅是依赖描述<br>6、堪称完美的清单，下面 让我们实现它。</p>\n<h2 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h2><p>首先，定义一个对象叫做injector，<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> injector = &#123;</span><br><span class=\"line\">  dependencies: &#123;&#125;,</span><br><span class=\"line\">  register: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, src</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.dependencies[name] = src;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  resolve: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">target</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"string\">`</span></span><br></pre></td></tr></table></figure></p>\n<p>injector对象中有两个方法，regist负责注册需要依赖的模块并存在dependencies中，第二个方法是resolve，这个方法接收的参数是我们我们要注入依赖的对象，这里的关键的点就是这个注入器不应该调用我们的函数，所以我们在resolve方法中返回一个闭包来包裹我们的target,然后再调用它：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">resolve: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">target</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    target();</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>下一步到AngularJS源码中找到annotate方法，此方法将目标函数转换为一个字符串，删除它的注释(如果有)，然后提取他的参数(依赖项)：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> FN_ARGS = <span class=\"regexp\">/^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> STRIP_COMMENTS = <span class=\"regexp\">/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg</span>;</span><br><span class=\"line\">fnText = target.toString().replace(STRIP_COMMENTS, <span class=\"string\">''</span>);</span><br><span class=\"line\">argDecl = fnText.match(FN_ARGS)[<span class=\"number\">1</span>].split(<span class=\"regexp\">/, ?/g</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> args = [];</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; argDecl.length; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.dependencies[argDecl[i]]) &#123;</span><br><span class=\"line\">       args.push(<span class=\"keyword\">this</span>.dependencies[argDecl[i]]);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">     target.apply(&#123;&#125;, args);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> injector = &#123;</span><br><span class=\"line\">            <span class=\"comment\">//依赖库</span></span><br><span class=\"line\">            dependencies: &#123;&#125;,</span><br><span class=\"line\">            <span class=\"comment\">//注册依赖</span></span><br><span class=\"line\">            regist: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">name, src</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.dependencies[name] = src;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"comment\">/**</span><br><span class=\"line\">             * 返回闭包包裹要调用的函数</span><br><span class=\"line\">             * @param target 需要注入的对象</span><br><span class=\"line\">             * @returns &#123;Function&#125;</span><br><span class=\"line\">             */</span></span><br><span class=\"line\">            resolve: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">target</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> FN_ARGS = <span class=\"regexp\">/^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m</span>;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> STRIP_COMMENTS = <span class=\"regexp\">/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg</span>;</span><br><span class=\"line\">                fnText = target.toString().replace(STRIP_COMMENTS, <span class=\"string\">''</span>);</span><br><span class=\"line\">                argDecl = fnText.match(FN_ARGS)[<span class=\"number\">1</span>].split(<span class=\"regexp\">/, ?/g</span>);</span><br><span class=\"line\">                <span class=\"keyword\">var</span> args = [];</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; argDecl.length; i++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.dependencies[argDecl[i]]) &#123;</span><br><span class=\"line\">                        args.push(<span class=\"keyword\">this</span>.dependencies[argDecl[i]]);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                    target.apply(&#123;&#125;, args);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br></pre></td></tr></table></figure>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}